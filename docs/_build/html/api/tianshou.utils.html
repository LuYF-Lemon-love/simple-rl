<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>tianshou.utils &mdash; Tianshou 0.5.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/style.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/documentation_options.js?v=b9afe91b"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="https://cdn.jsdelivr.net/npm/vega@5.20.2"></script>
        <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.1.0"></script>
        <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.17.0"></script>
        <script src="../_static/js/copybutton.js?v=7db002fe"></script>
        <script src="../_static/js/benchmark.js?v=1091b9f3"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Contributing to Tianshou" href="../contributing.html" />
    <link rel="prev" title="tianshou.exploration" href="tianshou.exploration.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Tianshou
              <img src="../_static/tianshou-logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.5.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/get_started.html">Get Started with Jupyter Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/dqn.html">Deep Q Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/concepts.html">Basic concepts in Tianshou</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/batch.html">Understand Batch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/tictactoe.html">Multi-Agent RL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/logger.html">Logging Experiments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/benchmark.html">Benchmark</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/cheatsheet.html">Cheat Sheet</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Docs</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tianshou.data.html">tianshou.data</a></li>
<li class="toctree-l1"><a class="reference internal" href="tianshou.env.html">tianshou.env</a></li>
<li class="toctree-l1"><a class="reference internal" href="tianshou.policy.html">tianshou.policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="tianshou.trainer.html">tianshou.trainer</a></li>
<li class="toctree-l1"><a class="reference internal" href="tianshou.exploration.html">tianshou.exploration</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">tianshou.utils</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#tianshou.utils.MovAvg"><code class="docutils literal notranslate"><span class="pre">MovAvg</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tianshou.utils.MovAvg.add"><code class="docutils literal notranslate"><span class="pre">MovAvg.add()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tianshou.utils.MovAvg.get"><code class="docutils literal notranslate"><span class="pre">MovAvg.get()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tianshou.utils.MovAvg.mean"><code class="docutils literal notranslate"><span class="pre">MovAvg.mean()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tianshou.utils.MovAvg.std"><code class="docutils literal notranslate"><span class="pre">MovAvg.std()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tianshou.utils.RunningMeanStd"><code class="docutils literal notranslate"><span class="pre">RunningMeanStd</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tianshou.utils.RunningMeanStd.norm"><code class="docutils literal notranslate"><span class="pre">RunningMeanStd.norm()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tianshou.utils.RunningMeanStd.update"><code class="docutils literal notranslate"><span class="pre">RunningMeanStd.update()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tianshou.utils.DummyTqdm"><code class="docutils literal notranslate"><span class="pre">DummyTqdm</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tianshou.utils.DummyTqdm.set_postfix"><code class="docutils literal notranslate"><span class="pre">DummyTqdm.set_postfix()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tianshou.utils.DummyTqdm.update"><code class="docutils literal notranslate"><span class="pre">DummyTqdm.update()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tianshou.utils.BaseLogger"><code class="docutils literal notranslate"><span class="pre">BaseLogger</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tianshou.utils.BaseLogger.write"><code class="docutils literal notranslate"><span class="pre">BaseLogger.write()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tianshou.utils.BaseLogger.log_train_data"><code class="docutils literal notranslate"><span class="pre">BaseLogger.log_train_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tianshou.utils.BaseLogger.log_test_data"><code class="docutils literal notranslate"><span class="pre">BaseLogger.log_test_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tianshou.utils.BaseLogger.log_update_data"><code class="docutils literal notranslate"><span class="pre">BaseLogger.log_update_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tianshou.utils.BaseLogger.save_data"><code class="docutils literal notranslate"><span class="pre">BaseLogger.save_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tianshou.utils.BaseLogger.restore_data"><code class="docutils literal notranslate"><span class="pre">BaseLogger.restore_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tianshou.utils.TensorboardLogger"><code class="docutils literal notranslate"><span class="pre">TensorboardLogger</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tianshou.utils.TensorboardLogger.write"><code class="docutils literal notranslate"><span class="pre">TensorboardLogger.write()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tianshou.utils.TensorboardLogger.save_data"><code class="docutils literal notranslate"><span class="pre">TensorboardLogger.save_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tianshou.utils.TensorboardLogger.restore_data"><code class="docutils literal notranslate"><span class="pre">TensorboardLogger.restore_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tianshou.utils.BasicLogger"><code class="docutils literal notranslate"><span class="pre">BasicLogger</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#tianshou.utils.LazyLogger"><code class="docutils literal notranslate"><span class="pre">LazyLogger</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tianshou.utils.LazyLogger.write"><code class="docutils literal notranslate"><span class="pre">LazyLogger.write()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tianshou.utils.LazyLogger.save_data"><code class="docutils literal notranslate"><span class="pre">LazyLogger.save_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tianshou.utils.LazyLogger.restore_data"><code class="docutils literal notranslate"><span class="pre">LazyLogger.restore_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tianshou.utils.WandbLogger"><code class="docutils literal notranslate"><span class="pre">WandbLogger</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tianshou.utils.WandbLogger.load"><code class="docutils literal notranslate"><span class="pre">WandbLogger.load()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tianshou.utils.WandbLogger.write"><code class="docutils literal notranslate"><span class="pre">WandbLogger.write()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tianshou.utils.WandbLogger.save_data"><code class="docutils literal notranslate"><span class="pre">WandbLogger.save_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tianshou.utils.WandbLogger.restore_data"><code class="docutils literal notranslate"><span class="pre">WandbLogger.restore_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tianshou.utils.deprecation"><code class="docutils literal notranslate"><span class="pre">deprecation()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#tianshou.utils.MultipleLRSchedulers"><code class="docutils literal notranslate"><span class="pre">MultipleLRSchedulers</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tianshou.utils.MultipleLRSchedulers.step"><code class="docutils literal notranslate"><span class="pre">MultipleLRSchedulers.step()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tianshou.utils.MultipleLRSchedulers.state_dict"><code class="docutils literal notranslate"><span class="pre">MultipleLRSchedulers.state_dict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tianshou.utils.MultipleLRSchedulers.load_state_dict"><code class="docutils literal notranslate"><span class="pre">MultipleLRSchedulers.load_state_dict()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pre-defined-networks">Pre-defined Networks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#common">Common</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.utils.net.common.miniblock"><code class="docutils literal notranslate"><span class="pre">miniblock()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.utils.net.common.MLP"><code class="docutils literal notranslate"><span class="pre">MLP</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.utils.net.common.NetBase"><code class="docutils literal notranslate"><span class="pre">NetBase</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.utils.net.common.Net"><code class="docutils literal notranslate"><span class="pre">Net</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.utils.net.common.Recurrent"><code class="docutils literal notranslate"><span class="pre">Recurrent</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.utils.net.common.ActorCritic"><code class="docutils literal notranslate"><span class="pre">ActorCritic</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.utils.net.common.DataParallelNet"><code class="docutils literal notranslate"><span class="pre">DataParallelNet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.utils.net.common.EnsembleLinear"><code class="docutils literal notranslate"><span class="pre">EnsembleLinear</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.utils.net.common.BranchingNet"><code class="docutils literal notranslate"><span class="pre">BranchingNet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.utils.net.common.get_dict_state_decorator"><code class="docutils literal notranslate"><span class="pre">get_dict_state_decorator()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#discrete">Discrete</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.utils.net.discrete.Actor"><code class="docutils literal notranslate"><span class="pre">Actor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.utils.net.discrete.Critic"><code class="docutils literal notranslate"><span class="pre">Critic</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.utils.net.discrete.CosineEmbeddingNetwork"><code class="docutils literal notranslate"><span class="pre">CosineEmbeddingNetwork</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.utils.net.discrete.ImplicitQuantileNetwork"><code class="docutils literal notranslate"><span class="pre">ImplicitQuantileNetwork</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.utils.net.discrete.FractionProposalNetwork"><code class="docutils literal notranslate"><span class="pre">FractionProposalNetwork</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.utils.net.discrete.FullQuantileFunction"><code class="docutils literal notranslate"><span class="pre">FullQuantileFunction</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.utils.net.discrete.NoisyLinear"><code class="docutils literal notranslate"><span class="pre">NoisyLinear</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.utils.net.discrete.sample_noise"><code class="docutils literal notranslate"><span class="pre">sample_noise()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.utils.net.discrete.IntrinsicCuriosityModule"><code class="docutils literal notranslate"><span class="pre">IntrinsicCuriosityModule</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#continuous">Continuous</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.utils.net.continuous.Actor"><code class="docutils literal notranslate"><span class="pre">Actor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.utils.net.continuous.Critic"><code class="docutils literal notranslate"><span class="pre">Critic</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.utils.net.continuous.ActorProb"><code class="docutils literal notranslate"><span class="pre">ActorProb</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.utils.net.continuous.RecurrentActorProb"><code class="docutils literal notranslate"><span class="pre">RecurrentActorProb</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.utils.net.continuous.RecurrentCritic"><code class="docutils literal notranslate"><span class="pre">RecurrentCritic</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.utils.net.continuous.Perturbation"><code class="docutils literal notranslate"><span class="pre">Perturbation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.utils.net.continuous.VAE"><code class="docutils literal notranslate"><span class="pre">VAE</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing to Tianshou</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributor.html">Contributor</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Tianshou</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">tianshou.utils</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/tianshou.utils.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tianshou-utils">
<h1>tianshou.utils<a class="headerlink" href="#tianshou-utils" title="Link to this heading">¶</a></h1>
<p id="module-tianshou.utils">Utils package.</p>
<dl class="py class">
<dt class="sig sig-object py" id="tianshou.utils.MovAvg">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.utils.</span></span><span class="sig-name descname"><span class="pre">MovAvg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/utils/statistics.html#MovAvg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.MovAvg" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for moving average.</p>
<p>It will automatically exclude the infinity and NaN. Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stat</span> <span class="o">=</span> <span class="n">MovAvg</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">66</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stat</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">5.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stat</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">))</span>  <span class="c1"># which will not add to stat</span>
<span class="go">5.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stat</span><span class="o">.</span><span class="n">add</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="go">6.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stat</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="go">6.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">stat</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">±</span><span class="si">{</span><span class="n">stat</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="go">6.50±1.12</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.MovAvg.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Number</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">number</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/statistics.html#MovAvg.add"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.MovAvg.add" title="Link to this definition">¶</a></dt>
<dd><p>Add a scalar into <a class="reference internal" href="#tianshou.utils.MovAvg" title="tianshou.utils.MovAvg"><code class="xref py py-class docutils literal notranslate"><span class="pre">MovAvg</span></code></a>.</p>
<p>You can add <code class="docutils literal notranslate"><span class="pre">torch.Tensor</span></code> with only one element, a python scalar, or
a list of python scalar.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.MovAvg.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/statistics.html#MovAvg.get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.MovAvg.get" title="Link to this definition">¶</a></dt>
<dd><p>Get the average.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.MovAvg.mean">
<span class="sig-name descname"><span class="pre">mean</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/statistics.html#MovAvg.mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.MovAvg.mean" title="Link to this definition">¶</a></dt>
<dd><p>Get the average. Same as <a class="reference internal" href="#tianshou.utils.MovAvg.get" title="tianshou.utils.MovAvg.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.MovAvg.std">
<span class="sig-name descname"><span class="pre">std</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/statistics.html#MovAvg.std"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.MovAvg.std" title="Link to this definition">¶</a></dt>
<dd><p>Get the standard deviation.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tianshou.utils.RunningMeanStd">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.utils.</span></span><span class="sig-name descname"><span class="pre">RunningMeanStd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.1920928955078125e-07</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/utils/statistics.html#RunningMeanStd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.RunningMeanStd" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Calculates the running mean and std of a data stream.</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Algorithms_for_calculating_variance#Parallel_algorithm">https://en.wikipedia.org/wiki/Algorithms_for_calculating_variance#Parallel_algorithm</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mean</strong> – the initial mean estimation for data array. Default to 0.</p></li>
<li><p><strong>std</strong> – the initial standard error estimation for data array. Default to 1.</p></li>
<li><p><strong>clip_max</strong> (<em>float</em>) – the maximum absolute value for data array. Default to
10.0.</p></li>
<li><p><strong>epsilon</strong> (<em>float</em>) – To avoid division by zero.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.RunningMeanStd.norm">
<span class="sig-name descname"><span class="pre">norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/statistics.html#RunningMeanStd.norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.RunningMeanStd.norm" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.RunningMeanStd.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/statistics.html#RunningMeanStd.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.RunningMeanStd.update" title="Link to this definition">¶</a></dt>
<dd><p>Add a batch of item into RMS with the same shape, modify mean/var/count.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tianshou.utils.DummyTqdm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.utils.</span></span><span class="sig-name descname"><span class="pre">DummyTqdm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">total</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/utils/progress_bar.html#DummyTqdm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.DummyTqdm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A dummy tqdm class that keeps stats but without progress bar.</p>
<p>It supports <code class="docutils literal notranslate"><span class="pre">__enter__</span></code> and <code class="docutils literal notranslate"><span class="pre">__exit__</span></code>, update and a dummy
<code class="docutils literal notranslate"><span class="pre">set_postfix</span></code>, which is the interface that trainers use.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">disable=True</span></code> in tqdm config results in infinite loop, thus
this class is created. See the discussion at #641 for details.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.DummyTqdm.set_postfix">
<span class="sig-name descname"><span class="pre">set_postfix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/progress_bar.html#DummyTqdm.set_postfix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.DummyTqdm.set_postfix" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.DummyTqdm.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/progress_bar.html#DummyTqdm.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.DummyTqdm.update" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tianshou.utils.BaseLogger">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.utils.</span></span><span class="sig-name descname"><span class="pre">BaseLogger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_interval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_interval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_interval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/utils/logger/base.html#BaseLogger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.BaseLogger" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>The base class for any logger which is compatible with trainer.</p>
<p>Try to overwrite write() method to use your own writer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_interval</strong> (<em>int</em>) – the log interval in log_train_data(). Default to 1000.</p></li>
<li><p><strong>test_interval</strong> (<em>int</em>) – the log interval in log_test_data(). Default to 1.</p></li>
<li><p><strong>update_interval</strong> (<em>int</em>) – the log interval in log_update_data(). Default to 1000.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.BaseLogger.write">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Number</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">number</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/logger/base.html#BaseLogger.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.BaseLogger.write" title="Link to this definition">¶</a></dt>
<dd><p>Specify how the writer is used to log data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_type</strong> (<em>str</em>) – namespace which the data dict belongs to.</p></li>
<li><p><strong>step</strong> (<em>int</em>) – stands for the ordinate of the data dict.</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – the data to write with format <code class="docutils literal notranslate"><span class="pre">{key:</span> <span class="pre">value}</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.BaseLogger.log_train_data">
<span class="sig-name descname"><span class="pre">log_train_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">collect_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/logger/base.html#BaseLogger.log_train_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.BaseLogger.log_train_data" title="Link to this definition">¶</a></dt>
<dd><p>Use writer to log statistics generated during training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>collect_result</strong> – a dict containing information of data collected in
training stage, i.e., returns of collector.collect().</p></li>
<li><p><strong>step</strong> (<em>int</em>) – stands for the timestep the collect_result being logged.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.BaseLogger.log_test_data">
<span class="sig-name descname"><span class="pre">log_test_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">collect_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/logger/base.html#BaseLogger.log_test_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.BaseLogger.log_test_data" title="Link to this definition">¶</a></dt>
<dd><p>Use writer to log statistics generated during evaluating.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>collect_result</strong> – a dict containing information of data collected in
evaluating stage, i.e., returns of collector.collect().</p></li>
<li><p><strong>step</strong> (<em>int</em>) – stands for the timestep the collect_result being logged.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.BaseLogger.log_update_data">
<span class="sig-name descname"><span class="pre">log_update_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">update_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/logger/base.html#BaseLogger.log_update_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.BaseLogger.log_update_data" title="Link to this definition">¶</a></dt>
<dd><p>Use writer to log statistics generated during updating.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>update_result</strong> – a dict containing information of data collected in
updating stage, i.e., returns of policy.update().</p></li>
<li><p><strong>step</strong> (<em>int</em>) – stands for the timestep the collect_result being logged.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.BaseLogger.save_data">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">save_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_checkpoint_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/logger/base.html#BaseLogger.save_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.BaseLogger.save_data" title="Link to this definition">¶</a></dt>
<dd><p>Use writer to log metadata when calling <code class="docutils literal notranslate"><span class="pre">save_checkpoint_fn</span></code> in trainer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epoch</strong> (<em>int</em>) – the epoch in trainer.</p></li>
<li><p><strong>env_step</strong> (<em>int</em>) – the env_step in trainer.</p></li>
<li><p><strong>gradient_step</strong> (<em>int</em>) – the gradient_step in trainer.</p></li>
<li><p><strong>save_checkpoint_fn</strong> (<em>function</em>) – a hook defined by user, see trainer
documentation for detail.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.BaseLogger.restore_data">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">restore_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/utils/logger/base.html#BaseLogger.restore_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.BaseLogger.restore_data" title="Link to this definition">¶</a></dt>
<dd><p>Return the metadata from existing log.</p>
<p>If it finds nothing or an error occurs during the recover process, it will
return the default parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>epoch, env_step, gradient_step.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tianshou.utils.TensorboardLogger">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.utils.</span></span><span class="sig-name descname"><span class="pre">TensorboardLogger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">writer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">SummaryWriter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_interval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_interval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_interval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_interval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_flush</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/utils/logger/tensorboard.html#TensorboardLogger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.TensorboardLogger" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tianshou.utils.BaseLogger" title="tianshou.utils.logger.base.BaseLogger"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLogger</span></code></a></p>
<p>A logger that relies on tensorboard SummaryWriter by default to visualize     and log statistics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>writer</strong> (<em>SummaryWriter</em>) – the writer to log data.</p></li>
<li><p><strong>train_interval</strong> (<em>int</em>) – the log interval in log_train_data(). Default to 1000.</p></li>
<li><p><strong>test_interval</strong> (<em>int</em>) – the log interval in log_test_data(). Default to 1.</p></li>
<li><p><strong>update_interval</strong> (<em>int</em>) – the log interval in log_update_data(). Default to 1000.</p></li>
<li><p><strong>save_interval</strong> (<em>int</em>) – the save interval in save_data(). Default to 1 (save at
the end of each epoch).</p></li>
<li><p><strong>write_flush</strong> (<em>bool</em>) – whether to flush tensorboard result after each
add_scalar operation. Default to True.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.TensorboardLogger.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Number</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">number</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/logger/tensorboard.html#TensorboardLogger.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.TensorboardLogger.write" title="Link to this definition">¶</a></dt>
<dd><p>Specify how the writer is used to log data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_type</strong> (<em>str</em>) – namespace which the data dict belongs to.</p></li>
<li><p><strong>step</strong> (<em>int</em>) – stands for the ordinate of the data dict.</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – the data to write with format <code class="docutils literal notranslate"><span class="pre">{key:</span> <span class="pre">value}</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.TensorboardLogger.save_data">
<span class="sig-name descname"><span class="pre">save_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_checkpoint_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/logger/tensorboard.html#TensorboardLogger.save_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.TensorboardLogger.save_data" title="Link to this definition">¶</a></dt>
<dd><p>Use writer to log metadata when calling <code class="docutils literal notranslate"><span class="pre">save_checkpoint_fn</span></code> in trainer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epoch</strong> (<em>int</em>) – the epoch in trainer.</p></li>
<li><p><strong>env_step</strong> (<em>int</em>) – the env_step in trainer.</p></li>
<li><p><strong>gradient_step</strong> (<em>int</em>) – the gradient_step in trainer.</p></li>
<li><p><strong>save_checkpoint_fn</strong> (<em>function</em>) – a hook defined by user, see trainer
documentation for detail.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.TensorboardLogger.restore_data">
<span class="sig-name descname"><span class="pre">restore_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/utils/logger/tensorboard.html#TensorboardLogger.restore_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.TensorboardLogger.restore_data" title="Link to this definition">¶</a></dt>
<dd><p>Return the metadata from existing log.</p>
<p>If it finds nothing or an error occurs during the recover process, it will
return the default parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>epoch, env_step, gradient_step.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tianshou.utils.BasicLogger">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.utils.</span></span><span class="sig-name descname"><span class="pre">BasicLogger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/utils/logger/tensorboard.html#BasicLogger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.BasicLogger" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tianshou.utils.TensorboardLogger" title="tianshou.utils.logger.tensorboard.TensorboardLogger"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorboardLogger</span></code></a></p>
<p>BasicLogger has changed its name to TensorboardLogger in #427.</p>
<p>This class is for compatibility.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tianshou.utils.LazyLogger">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.utils.</span></span><span class="sig-name descname"><span class="pre">LazyLogger</span></span><a class="reference internal" href="../_modules/tianshou/utils/logger/base.html#LazyLogger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.LazyLogger" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tianshou.utils.BaseLogger" title="tianshou.utils.logger.base.BaseLogger"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLogger</span></code></a></p>
<p>A logger that does nothing. Used as the placeholder in trainer.</p>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.LazyLogger.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Number</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">number</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/logger/base.html#LazyLogger.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.LazyLogger.write" title="Link to this definition">¶</a></dt>
<dd><p>The LazyLogger writes nothing.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.LazyLogger.save_data">
<span class="sig-name descname"><span class="pre">save_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_checkpoint_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/logger/base.html#LazyLogger.save_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.LazyLogger.save_data" title="Link to this definition">¶</a></dt>
<dd><p>Use writer to log metadata when calling <code class="docutils literal notranslate"><span class="pre">save_checkpoint_fn</span></code> in trainer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epoch</strong> (<em>int</em>) – the epoch in trainer.</p></li>
<li><p><strong>env_step</strong> (<em>int</em>) – the env_step in trainer.</p></li>
<li><p><strong>gradient_step</strong> (<em>int</em>) – the gradient_step in trainer.</p></li>
<li><p><strong>save_checkpoint_fn</strong> (<em>function</em>) – a hook defined by user, see trainer
documentation for detail.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.LazyLogger.restore_data">
<span class="sig-name descname"><span class="pre">restore_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/utils/logger/base.html#LazyLogger.restore_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.LazyLogger.restore_data" title="Link to this definition">¶</a></dt>
<dd><p>Return the metadata from existing log.</p>
<p>If it finds nothing or an error occurs during the recover process, it will
return the default parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>epoch, env_step, gradient_step.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tianshou.utils.WandbLogger">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.utils.</span></span><span class="sig-name descname"><span class="pre">WandbLogger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_interval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_interval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_interval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_interval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_flush</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">project</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Namespace</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor_gym</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/utils/logger/wandb.html#WandbLogger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.WandbLogger" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tianshou.utils.BaseLogger" title="tianshou.utils.logger.base.BaseLogger"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLogger</span></code></a></p>
<p>Weights and Biases logger that sends data to <a class="reference external" href="https://wandb.ai/">https://wandb.ai/</a>.</p>
<p>This logger creates three panels with plots: train, test, and update.
Make sure to select the correct access for each panel in weights and biases:</p>
<p>Example of usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">logger</span> <span class="o">=</span> <span class="n">WandbLogger</span><span class="p">()</span>
<span class="n">logger</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">SummaryWriter</span><span class="p">(</span><span class="n">log_path</span><span class="p">))</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">OnpolicyTrainer</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">train_collector</span><span class="p">,</span> <span class="n">test_collector</span><span class="p">,</span>
                          <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_interval</strong> (<em>int</em>) – the log interval in log_train_data(). Default to 1000.</p></li>
<li><p><strong>test_interval</strong> (<em>int</em>) – the log interval in log_test_data(). Default to 1.</p></li>
<li><p><strong>update_interval</strong> (<em>int</em>) – the log interval in log_update_data().
Default to 1000.</p></li>
<li><p><strong>save_interval</strong> (<em>int</em>) – the save interval in save_data(). Default to 1 (save at
the end of each epoch).</p></li>
<li><p><strong>write_flush</strong> (<em>bool</em>) – whether to flush tensorboard result after each
add_scalar operation. Default to True.</p></li>
<li><p><strong>project</strong> (<em>str</em>) – W&amp;B project name. Default to “tianshou”.</p></li>
<li><p><strong>name</strong> (<em>str</em>) – W&amp;B run name. Default to None. If None, random name is assigned.</p></li>
<li><p><strong>entity</strong> (<em>str</em>) – W&amp;B team/organization name. Default to None.</p></li>
<li><p><strong>run_id</strong> (<em>str</em>) – run id of W&amp;B run to be resumed. Default to None.</p></li>
<li><p><strong>config</strong> (<em>argparse.Namespace</em>) – experiment configurations. Default to None.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.WandbLogger.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">writer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">SummaryWriter</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/logger/wandb.html#WandbLogger.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.WandbLogger.load" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.WandbLogger.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Number</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">number</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/logger/wandb.html#WandbLogger.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.WandbLogger.write" title="Link to this definition">¶</a></dt>
<dd><p>Specify how the writer is used to log data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_type</strong> (<em>str</em>) – namespace which the data dict belongs to.</p></li>
<li><p><strong>step</strong> (<em>int</em>) – stands for the ordinate of the data dict.</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – the data to write with format <code class="docutils literal notranslate"><span class="pre">{key:</span> <span class="pre">value}</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.WandbLogger.save_data">
<span class="sig-name descname"><span class="pre">save_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_checkpoint_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/logger/wandb.html#WandbLogger.save_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.WandbLogger.save_data" title="Link to this definition">¶</a></dt>
<dd><p>Use writer to log metadata when calling <code class="docutils literal notranslate"><span class="pre">save_checkpoint_fn</span></code> in trainer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epoch</strong> (<em>int</em>) – the epoch in trainer.</p></li>
<li><p><strong>env_step</strong> (<em>int</em>) – the env_step in trainer.</p></li>
<li><p><strong>gradient_step</strong> (<em>int</em>) – the gradient_step in trainer.</p></li>
<li><p><strong>save_checkpoint_fn</strong> (<em>function</em>) – a hook defined by user, see trainer
documentation for detail.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.WandbLogger.restore_data">
<span class="sig-name descname"><span class="pre">restore_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/utils/logger/wandb.html#WandbLogger.restore_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.WandbLogger.restore_data" title="Link to this definition">¶</a></dt>
<dd><p>Return the metadata from existing log.</p>
<p>If it finds nothing or an error occurs during the recover process, it will
return the default parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>epoch, env_step, gradient_step.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tianshou.utils.deprecation">
<span class="sig-prename descclassname"><span class="pre">tianshou.utils.</span></span><span class="sig-name descname"><span class="pre">deprecation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/warning.html#deprecation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.deprecation" title="Link to this definition">¶</a></dt>
<dd><p>Deprecation warning wrapper.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tianshou.utils.MultipleLRSchedulers">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.utils.</span></span><span class="sig-name descname"><span class="pre">MultipleLRSchedulers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LambdaLR</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/utils/lr_scheduler.html#MultipleLRSchedulers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.MultipleLRSchedulers" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A wrapper for multiple learning rate schedulers.</p>
<p>Every time <a class="reference internal" href="#tianshou.utils.MultipleLRSchedulers.step" title="tianshou.utils.MultipleLRSchedulers.step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">step()</span></code></a> is called,
it calls the step() method of each of the schedulers that it contains.
Example usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">scheduler1</span> <span class="o">=</span> <span class="n">ConstantLR</span><span class="p">(</span><span class="n">opt1</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">total_iters</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">scheduler2</span> <span class="o">=</span> <span class="n">ExponentialLR</span><span class="p">(</span><span class="n">opt2</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
<span class="n">scheduler</span> <span class="o">=</span> <span class="n">MultipleLRSchedulers</span><span class="p">(</span><span class="n">scheduler1</span><span class="p">,</span> <span class="n">scheduler2</span><span class="p">)</span>
<span class="n">policy</span> <span class="o">=</span> <span class="n">PPOPolicy</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">lr_scheduler</span><span class="o">=</span><span class="n">scheduler</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.MultipleLRSchedulers.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/lr_scheduler.html#MultipleLRSchedulers.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.MultipleLRSchedulers.step" title="Link to this definition">¶</a></dt>
<dd><p>Take a step in each of the learning rate schedulers.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.MultipleLRSchedulers.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/utils/lr_scheduler.html#MultipleLRSchedulers.state_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.MultipleLRSchedulers.state_dict" title="Link to this definition">¶</a></dt>
<dd><p>Get state_dict for each of the learning rate schedulers.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of state_dict of learning rate schedulers.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.MultipleLRSchedulers.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/lr_scheduler.html#MultipleLRSchedulers.load_state_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.MultipleLRSchedulers.load_state_dict" title="Link to this definition">¶</a></dt>
<dd><p>Load states from state_dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>List</em><em>[</em><em>Dict</em><em>]</em>) – A list of learning rate scheduler
state_dict, in the same order as the schedulers.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<section id="pre-defined-networks">
<h2>Pre-defined Networks<a class="headerlink" href="#pre-defined-networks" title="Link to this heading">¶</a></h2>
<section id="common">
<h3>Common<a class="headerlink" href="#common" title="Link to this heading">¶</a></h3>
<dl class="py function" id="module-tianshou.utils.net.common">
<dt class="sig sig-object py" id="tianshou.utils.net.common.miniblock">
<span class="sig-prename descclassname"><span class="pre">tianshou.utils.net.common.</span></span><span class="sig-name descname"><span class="pre">miniblock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_size:</span> <span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_layer:</span> <span class="pre">~typing.Type[~torch.nn.modules.module.Module]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_args:</span> <span class="pre">~typing.Tuple[~typing.Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">...]</span> <span class="pre">|</span> <span class="pre">~typing.Dict[~typing.Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation:</span> <span class="pre">~typing.Type[~torch.nn.modules.module.Module]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_args:</span> <span class="pre">~typing.Tuple[~typing.Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">...]</span> <span class="pre">|</span> <span class="pre">~typing.Dict[~typing.Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linear_layer:</span> <span class="pre">~typing.Type[~torch.nn.modules.linear.Linear]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'torch.nn.modules.linear.Linear'&gt;</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Module</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/utils/net/common.html#miniblock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.common.miniblock" title="Link to this definition">¶</a></dt>
<dd><p>Construct a miniblock with given input/output-size, norm layer and     activation.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tianshou.utils.net.common.MLP">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.utils.net.common.</span></span><span class="sig-name descname"><span class="pre">MLP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim:</span> <span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dim:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_sizes:</span> <span class="pre">~typing.Sequence[int]</span> <span class="pre">=</span> <span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_layer:</span> <span class="pre">~typing.Type[~torch.nn.modules.module.Module]</span> <span class="pre">|</span> <span class="pre">~typing.Sequence[~typing.Type[~torch.nn.modules.module.Module]]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_args:</span> <span class="pre">~typing.Tuple[~typing.Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">...]</span> <span class="pre">|</span> <span class="pre">~typing.Dict[~typing.Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">|</span> <span class="pre">~typing.Sequence[~typing.Tuple[~typing.Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">...]]</span> <span class="pre">|</span> <span class="pre">~typing.Sequence[~typing.Dict[~typing.Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation:</span> <span class="pre">~typing.Type[~torch.nn.modules.module.Module]</span> <span class="pre">|</span> <span class="pre">~typing.Sequence[~typing.Type[~torch.nn.modules.module.Module]]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'torch.nn.modules.activation.ReLU'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_args:</span> <span class="pre">~typing.Tuple[~typing.Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">...]</span> <span class="pre">|</span> <span class="pre">~typing.Dict[~typing.Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">|</span> <span class="pre">~typing.Sequence[~typing.Tuple[~typing.Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">...]]</span> <span class="pre">|</span> <span class="pre">~typing.Sequence[~typing.Dict[~typing.Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">~torch.device</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linear_layer:</span> <span class="pre">~typing.Type[~torch.nn.modules.linear.Linear]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'torch.nn.modules.linear.Linear'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flatten_input:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/utils/net/common.html#MLP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.common.MLP" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Simple MLP backbone.</p>
<p>Create a MLP of size input_dim * hidden_sizes[0] * hidden_sizes[1] * …
* hidden_sizes[-1] * output_dim</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dim</strong> (<em>int</em>) – dimension of the input vector.</p></li>
<li><p><strong>output_dim</strong> (<em>int</em>) – dimension of the output vector. If set to 0, there
is no final linear layer.</p></li>
<li><p><strong>hidden_sizes</strong> – shape of MLP passed in as a list, not including
input_dim and output_dim.</p></li>
<li><p><strong>norm_layer</strong> – use which normalization before activation, e.g.,
<code class="docutils literal notranslate"><span class="pre">nn.LayerNorm</span></code> and <code class="docutils literal notranslate"><span class="pre">nn.BatchNorm1d</span></code>. Default to no normalization.
You can also pass a list of normalization modules with the same length
of hidden_sizes, to use different normalization module in different
layers. Default to no normalization.</p></li>
<li><p><strong>activation</strong> – which activation to use after each layer, can be both
the same activation for all layers if passed in nn.Module, or different
activation for different Modules if passed in a list. Default to
nn.ReLU.</p></li>
<li><p><strong>device</strong> – which device to create this model on. Default to None.</p></li>
<li><p><strong>linear_layer</strong> – use this module as linear layer. Default to nn.Linear.</p></li>
<li><p><strong>flatten_input</strong> (<em>bool</em>) – whether to flatten input data. Default to True.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.net.common.MLP.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/net/common.html#MLP.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.common.MLP.forward" title="Link to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tianshou.utils.net.common.NetBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.utils.net.common.</span></span><span class="sig-name descname"><span class="pre">NetBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/utils/net/common.html#NetBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.common.NetBase" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Interface for NNs used in policies.</p>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.net.common.NetBase.forward">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/utils/net/common.html#NetBase.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.common.NetBase.forward" title="Link to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tianshou.utils.net.common.Net">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.utils.net.common.</span></span><span class="sig-name descname"><span class="pre">Net</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">state_shape:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">~typing.Sequence[int],</span> <span class="pre">action_shape:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">~typing.Sequence[int]</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">hidden_sizes:</span> <span class="pre">~typing.Sequence[int]</span> <span class="pre">=</span> <span class="pre">(),</span> <span class="pre">norm_layer:</span> <span class="pre">~typing.Type[~torch.nn.modules.module.Module]</span> <span class="pre">|</span> <span class="pre">~typing.Sequence[~typing.Type[~torch.nn.modules.module.Module]]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">norm_args:</span> <span class="pre">~typing.Tuple[~typing.Any,</span> <span class="pre">...]</span> <span class="pre">|</span> <span class="pre">~typing.Dict[~typing.Any,</span> <span class="pre">~typing.Any]</span> <span class="pre">|</span> <span class="pre">~typing.Sequence[~typing.Tuple[~typing.Any,</span> <span class="pre">...]]</span> <span class="pre">|</span> <span class="pre">~typing.Sequence[~typing.Dict[~typing.Any,</span> <span class="pre">~typing.Any]]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">activation:</span> <span class="pre">~typing.Type[~torch.nn.modules.module.Module]</span> <span class="pre">|</span> <span class="pre">~typing.Sequence[~typing.Type[~torch.nn.modules.module.Module]]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'torch.nn.modules.activation.ReLU'&gt;,</span> <span class="pre">act_args:</span> <span class="pre">~typing.Tuple[~typing.Any,</span> <span class="pre">...]</span> <span class="pre">|</span> <span class="pre">~typing.Dict[~typing.Any,</span> <span class="pre">~typing.Any]</span> <span class="pre">|</span> <span class="pre">~typing.Sequence[~typing.Tuple[~typing.Any,</span> <span class="pre">...]]</span> <span class="pre">|</span> <span class="pre">~typing.Sequence[~typing.Dict[~typing.Any,</span> <span class="pre">~typing.Any]]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">device:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">~torch.device</span> <span class="pre">=</span> <span class="pre">'cpu',</span> <span class="pre">softmax:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">concat:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">num_atoms:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1,</span> <span class="pre">dueling_param:</span> <span class="pre">~typing.Tuple[~typing.Dict[str,</span> <span class="pre">~typing.Any],</span> <span class="pre">~typing.Dict[str,</span> <span class="pre">~typing.Any]]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">linear_layer:</span> <span class="pre">~typing.Type[~torch.nn.modules.linear.Linear]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'torch.nn.modules.linear.Linear'&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/utils/net/common.html#Net"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.common.Net" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tianshou.utils.net.common.NetBase" title="tianshou.utils.net.common.NetBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetBase</span></code></a></p>
<p>Wrapper of MLP to support more specific DRL usage.</p>
<p>For advanced usage (how to customize the network), please refer to
<a class="reference internal" href="../tutorials/dqn.html#build-the-network"><span class="std std-ref">Build the Network</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_shape</strong> – int or a sequence of int of the shape of state.</p></li>
<li><p><strong>action_shape</strong> – int or a sequence of int of the shape of action.</p></li>
<li><p><strong>hidden_sizes</strong> – shape of MLP passed in as a list.</p></li>
<li><p><strong>norm_layer</strong> – use which normalization before activation, e.g.,
<code class="docutils literal notranslate"><span class="pre">nn.LayerNorm</span></code> and <code class="docutils literal notranslate"><span class="pre">nn.BatchNorm1d</span></code>. Default to no normalization.
You can also pass a list of normalization modules with the same length
of hidden_sizes, to use different normalization module in different
layers. Default to no normalization.</p></li>
<li><p><strong>activation</strong> – which activation to use after each layer, can be both
the same activation for all layers if passed in nn.Module, or different
activation for different Modules if passed in a list. Default to
nn.ReLU.</p></li>
<li><p><strong>device</strong> – specify the device when the network actually runs. Default
to “cpu”.</p></li>
<li><p><strong>softmax</strong> (<em>bool</em>) – whether to apply a softmax layer over the last layer’s
output.</p></li>
<li><p><strong>concat</strong> (<em>bool</em>) – whether the input shape is concatenated by state_shape
and action_shape. If it is True, <code class="docutils literal notranslate"><span class="pre">action_shape</span></code> is not the output
shape, but affects the input shape only.</p></li>
<li><p><strong>num_atoms</strong> (<em>int</em>) – in order to expand to the net of distributional RL.
Default to 1 (not use).</p></li>
<li><p><strong>dueling_param</strong> (<em>bool</em>) – whether to use dueling network to calculate Q
values (for Dueling DQN). If you want to use dueling option, you should
pass a tuple of two dict (first for Q and second for V) stating
self-defined arguments as stated in
class:<cite>~tianshou.utils.net.common.MLP</cite>. Default to None.</p></li>
<li><p><strong>linear_layer</strong> – use this module as linear layer. Default to nn.Linear.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Please refer to <a class="reference internal" href="#tianshou.utils.net.common.MLP" title="tianshou.utils.net.common.MLP"><code class="xref py py-class docutils literal notranslate"><span class="pre">MLP</span></code></a> for more
detailed explanation on the usage of activation, norm_layer, etc.</p>
<p>You can also refer to <a class="reference internal" href="#tianshou.utils.net.continuous.Actor" title="tianshou.utils.net.continuous.Actor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Actor</span></code></a>,
<a class="reference internal" href="#tianshou.utils.net.continuous.Critic" title="tianshou.utils.net.continuous.Critic"><code class="xref py py-class docutils literal notranslate"><span class="pre">Critic</span></code></a>, etc, to see how it’s
suggested be used.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.net.common.Net.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/utils/net/common.html#Net.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.common.Net.forward" title="Link to this definition">¶</a></dt>
<dd><p>Mapping: obs -&gt; flatten (inside MLP)-&gt; logits.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> – </p></li>
<li><p><strong>state</strong> – unused and returned as is</p></li>
<li><p><strong>kwargs</strong> – unused</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tianshou.utils.net.common.Recurrent">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.utils.net.common.</span></span><span class="sig-name descname"><span class="pre">Recurrent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_layer_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/utils/net/common.html#Recurrent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.common.Recurrent" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tianshou.utils.net.common.NetBase" title="tianshou.utils.net.common.NetBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetBase</span></code></a></p>
<p>Simple Recurrent network based on LSTM.</p>
<p>For advanced usage (how to customize the network), please refer to
<a class="reference internal" href="../tutorials/dqn.html#build-the-network"><span class="std std-ref">Build the Network</span></a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.net.common.Recurrent.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">RecurrentStateBatch</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/utils/net/common.html#Recurrent.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.common.Recurrent.forward" title="Link to this definition">¶</a></dt>
<dd><p>Mapping: obs -&gt; flatten -&gt; logits.</p>
<p>In the evaluation mode, <cite>obs</cite> should be with shape <code class="docutils literal notranslate"><span class="pre">[bsz,</span> <span class="pre">dim]</span></code>; in the
training mode, <cite>obs</cite> should be with shape <code class="docutils literal notranslate"><span class="pre">[bsz,</span> <span class="pre">len,</span> <span class="pre">dim]</span></code>. See the code
and comment for more detail.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> – </p></li>
<li><p><strong>state</strong> – either None or a dict with keys ‘hidden’ and ‘cell’</p></li>
<li><p><strong>kwargs</strong> – unused</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>predicted action, next state as dict with keys ‘hidden’ and ‘cell’</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tianshou.utils.net.common.ActorCritic">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.utils.net.common.</span></span><span class="sig-name descname"><span class="pre">ActorCritic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">critic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/utils/net/common.html#ActorCritic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.common.ActorCritic" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>An actor-critic network for parsing parameters.</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">actor_critic.parameters()</span></code> instead of set.union or list+list to avoid
issue #449.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>actor</strong> (<em>nn.Module</em>) – the actor network.</p></li>
<li><p><strong>critic</strong> (<em>nn.Module</em>) – the critic network.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tianshou.utils.net.common.DataParallelNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.utils.net.common.</span></span><span class="sig-name descname"><span class="pre">DataParallelNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">net</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/utils/net/common.html#DataParallelNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.common.DataParallelNet" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>DataParallel wrapper for training agent with multi-GPU.</p>
<p>This class does only the conversion of input data type, from numpy array to torch’s
Tensor. If the input is a nested dictionary, the user should create a similar class
to do the same thing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>net</strong> (<em>nn.Module</em>) – the network to be distributed in different GPUs.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.net.common.DataParallelNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/utils/net/common.html#DataParallelNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.common.DataParallelNet.forward" title="Link to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tianshou.utils.net.common.EnsembleLinear">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.utils.net.common.</span></span><span class="sig-name descname"><span class="pre">EnsembleLinear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ensemble_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_feature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_feature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/utils/net/common.html#EnsembleLinear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.common.EnsembleLinear" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Linear Layer of Ensemble network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ensemble_size</strong> (<em>int</em>) – Number of subnets in the ensemble.</p></li>
<li><p><strong>in_feature</strong> (<em>int</em>) – dimension of the input vector.</p></li>
<li><p><strong>out_feature</strong> (<em>int</em>) – dimension of the output vector.</p></li>
<li><p><strong>bias</strong> (<em>bool</em>) – whether to include an additive bias, default to be True.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.net.common.EnsembleLinear.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/net/common.html#EnsembleLinear.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.common.EnsembleLinear.forward" title="Link to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tianshou.utils.net.common.BranchingNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.utils.net.common.</span></span><span class="sig-name descname"><span class="pre">BranchingNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">state_shape:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">~typing.Sequence[int],</span> <span class="pre">num_branches:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">action_per_branch:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">2,</span> <span class="pre">common_hidden_sizes:</span> <span class="pre">~typing.List[int]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">value_hidden_sizes:</span> <span class="pre">~typing.List[int]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">action_hidden_sizes:</span> <span class="pre">~typing.List[int]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">norm_layer:</span> <span class="pre">~typing.Type[~torch.nn.modules.module.Module]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">norm_args:</span> <span class="pre">~typing.Tuple[~typing.Any,</span> <span class="pre">...]</span> <span class="pre">|</span> <span class="pre">~typing.Dict[~typing.Any,</span> <span class="pre">~typing.Any]</span> <span class="pre">|</span> <span class="pre">~typing.Sequence[~typing.Tuple[~typing.Any,</span> <span class="pre">...]]</span> <span class="pre">|</span> <span class="pre">~typing.Sequence[~typing.Dict[~typing.Any,</span> <span class="pre">~typing.Any]]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">activation:</span> <span class="pre">~typing.Type[~torch.nn.modules.module.Module]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'torch.nn.modules.activation.ReLU'&gt;,</span> <span class="pre">act_args:</span> <span class="pre">~typing.Tuple[~typing.Any,</span> <span class="pre">...]</span> <span class="pre">|</span> <span class="pre">~typing.Dict[~typing.Any,</span> <span class="pre">~typing.Any]</span> <span class="pre">|</span> <span class="pre">~typing.Sequence[~typing.Tuple[~typing.Any,</span> <span class="pre">...]]</span> <span class="pre">|</span> <span class="pre">~typing.Sequence[~typing.Dict[~typing.Any,</span> <span class="pre">~typing.Any]]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">device:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">~torch.device</span> <span class="pre">=</span> <span class="pre">'cpu'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/utils/net/common.html#BranchingNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.common.BranchingNet" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tianshou.utils.net.common.NetBase" title="tianshou.utils.net.common.NetBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetBase</span></code></a></p>
<p>Branching dual Q network.</p>
<p>Network for the BranchingDQNPolicy, it uses a common network module, a value module
and action “branches” one for each dimension.It allows for a linear scaling
of Q-value the output w.r.t. the number of dimensions in the action space.
For more info please refer to: arXiv:1711.08946.
:param state_shape: int or a sequence of int of the shape of state.
:param action_shape: int or a sequence of int of the shape of action.
:param action_peer_branch: int or a sequence of int of the number of actions in
each dimension.
:param common_hidden_sizes: shape of the common MLP network passed in as a list.
:param value_hidden_sizes: shape of the value MLP network passed in as a list.
:param action_hidden_sizes: shape of the action MLP network passed in as a list.
:param norm_layer: use which normalization before activation, e.g.,
<code class="docutils literal notranslate"><span class="pre">nn.LayerNorm</span></code> and <code class="docutils literal notranslate"><span class="pre">nn.BatchNorm1d</span></code>. Default to no normalization.
You can also pass a list of normalization modules with the same length
of hidden_sizes, to use different normalization module in different
layers. Default to no normalization.
:param activation: which activation to use after each layer, can be both
the same activation for all layers if passed in nn.Module, or different
activation for different Modules if passed in a list. Default to
nn.ReLU.
:param device: specify the device when the network actually runs. Default
to “cpu”.
:param bool softmax: whether to apply a softmax layer over the last layer’s
output.</p>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.net.common.BranchingNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/utils/net/common.html#BranchingNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.common.BranchingNet.forward" title="Link to this definition">¶</a></dt>
<dd><p>Mapping: obs -&gt; model -&gt; logits.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tianshou.utils.net.common.get_dict_state_decorator">
<span class="sig-prename descclassname"><span class="pre">tianshou.utils.net.common.</span></span><span class="sig-name descname"><span class="pre">get_dict_state_decorator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/utils/net/common.html#get_dict_state_decorator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.common.get_dict_state_decorator" title="Link to this definition">¶</a></dt>
<dd><p>A helper function to make Net or equivalent classes (e.g. Actor, Critic)     applicable to dict state.</p>
<p>The first return item, <code class="docutils literal notranslate"><span class="pre">decorator_fn</span></code>, will alter the implementation of forward
function of the given class by preprocessing the observation. The preprocessing is
basically flatten the observation and concatenate them based on the <code class="docutils literal notranslate"><span class="pre">keys</span></code> order.
The batch dimension is preserved if presented. The result observation shape will
be equal to <code class="docutils literal notranslate"><span class="pre">new_state_shape</span></code>, the second return item.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_shape</strong> – A dictionary indicating each state’s shape</p></li>
<li><p><strong>keys</strong> – A list of state’s keys. The flatten observation will be according to     this list order.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a 2-items tuple <code class="docutils literal notranslate"><span class="pre">decorator_fn</span></code> and <code class="docutils literal notranslate"><span class="pre">new_state_shape</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="discrete">
<h3>Discrete<a class="headerlink" href="#discrete" title="Link to this heading">¶</a></h3>
<dl class="py class" id="module-tianshou.utils.net.discrete">
<dt class="sig sig-object py" id="tianshou.utils.net.discrete.Actor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.utils.net.discrete.</span></span><span class="sig-name descname"><span class="pre">Actor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preprocess_net</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_sizes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softmax_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocess_net_output_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/utils/net/discrete.html#Actor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.discrete.Actor" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Simple actor network.</p>
<p>Will create an actor operated in discrete action space with structure of
preprocess_net —&gt; action_shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preprocess_net</strong> – a self-defined preprocess_net which output a
flattened hidden state.</p></li>
<li><p><strong>action_shape</strong> – a sequence of int for the shape of action.</p></li>
<li><p><strong>hidden_sizes</strong> – a sequence of int for constructing the MLP after
preprocess_net. Default to empty sequence (where the MLP now contains
only a single linear layer).</p></li>
<li><p><strong>softmax_output</strong> (<em>bool</em>) – whether to apply a softmax layer over the last
layer’s output.</p></li>
<li><p><strong>preprocess_net_output_dim</strong> (<em>int</em>) – the output dimension of
preprocess_net.</p></li>
</ul>
</dd>
</dl>
<p>For advanced usage (how to customize the network), please refer to
<a class="reference internal" href="../tutorials/dqn.html#build-the-network"><span class="std std-ref">Build the Network</span></a>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Please refer to <a class="reference internal" href="#tianshou.utils.net.common.Net" title="tianshou.utils.net.common.Net"><code class="xref py py-class docutils literal notranslate"><span class="pre">Net</span></code></a> as an instance
of how preprocess_net is suggested to be defined.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.net.discrete.Actor.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/utils/net/discrete.html#Actor.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.discrete.Actor.forward" title="Link to this definition">¶</a></dt>
<dd><p>Mapping: s -&gt; Q(s, *).</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tianshou.utils.net.discrete.Critic">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.utils.net.discrete.</span></span><span class="sig-name descname"><span class="pre">Critic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preprocess_net</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_sizes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocess_net_output_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/utils/net/discrete.html#Critic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.discrete.Critic" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Simple critic network. Will create an actor operated in discrete     action space with structure of preprocess_net —&gt; 1(q value).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preprocess_net</strong> – a self-defined preprocess_net which output a
flattened hidden state.</p></li>
<li><p><strong>hidden_sizes</strong> – a sequence of int for constructing the MLP after
preprocess_net. Default to empty sequence (where the MLP now contains
only a single linear layer).</p></li>
<li><p><strong>last_size</strong> (<em>int</em>) – the output dimension of Critic network. Default to 1.</p></li>
<li><p><strong>preprocess_net_output_dim</strong> (<em>int</em>) – the output dimension of
preprocess_net.</p></li>
</ul>
</dd>
</dl>
<p>For advanced usage (how to customize the network), please refer to
<a class="reference internal" href="../tutorials/dqn.html#build-the-network"><span class="std std-ref">Build the Network</span></a>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Please refer to <a class="reference internal" href="#tianshou.utils.net.common.Net" title="tianshou.utils.net.common.Net"><code class="xref py py-class docutils literal notranslate"><span class="pre">Net</span></code></a> as an instance
of how preprocess_net is suggested to be defined.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.net.discrete.Critic.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/net/discrete.html#Critic.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.discrete.Critic.forward" title="Link to this definition">¶</a></dt>
<dd><p>Mapping: s -&gt; V(s).</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tianshou.utils.net.discrete.CosineEmbeddingNetwork">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.utils.net.discrete.</span></span><span class="sig-name descname"><span class="pre">CosineEmbeddingNetwork</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_cosines</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/utils/net/discrete.html#CosineEmbeddingNetwork"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.discrete.CosineEmbeddingNetwork" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Cosine embedding network for IQN. Convert a scalar in [0, 1] to a list     of n-dim vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_cosines</strong> – the number of cosines used for the embedding.</p></li>
<li><p><strong>embedding_dim</strong> – the dimension of the embedding/output.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>From <a class="reference external" href="https://github.com/ku2482/fqf-iqn-qrdqn.pytorch/blob/master">https://github.com/ku2482/fqf-iqn-qrdqn.pytorch/blob/master</a>
/fqf_iqn_qrdqn/network.py .</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.net.discrete.CosineEmbeddingNetwork.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">taus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/net/discrete.html#CosineEmbeddingNetwork.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.discrete.CosineEmbeddingNetwork.forward" title="Link to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tianshou.utils.net.discrete.ImplicitQuantileNetwork">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.utils.net.discrete.</span></span><span class="sig-name descname"><span class="pre">ImplicitQuantileNetwork</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preprocess_net</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_sizes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_cosines</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocess_net_output_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/utils/net/discrete.html#ImplicitQuantileNetwork"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.discrete.ImplicitQuantileNetwork" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tianshou.utils.net.discrete.Critic" title="tianshou.utils.net.discrete.Critic"><code class="xref py py-class docutils literal notranslate"><span class="pre">Critic</span></code></a></p>
<p>Implicit Quantile Network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preprocess_net</strong> – a self-defined preprocess_net which output a
flattened hidden state.</p></li>
<li><p><strong>action_shape</strong> (<em>int</em>) – a sequence of int for the shape of action.</p></li>
<li><p><strong>hidden_sizes</strong> – a sequence of int for constructing the MLP after
preprocess_net. Default to empty sequence (where the MLP now contains
only a single linear layer).</p></li>
<li><p><strong>num_cosines</strong> (<em>int</em>) – the number of cosines to use for cosine embedding.
Default to 64.</p></li>
<li><p><strong>preprocess_net_output_dim</strong> (<em>int</em>) – the output dimension of
preprocess_net.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although this class inherits Critic, it is actually a quantile Q-Network
with output shape (batch_size, action_dim, sample_size).</p>
<p>The second item of the first return value is tau vector.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.net.discrete.ImplicitQuantileNetwork.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/utils/net/discrete.html#ImplicitQuantileNetwork.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.discrete.ImplicitQuantileNetwork.forward" title="Link to this definition">¶</a></dt>
<dd><p>Mapping: s -&gt; Q(s, *).</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tianshou.utils.net.discrete.FractionProposalNetwork">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.utils.net.discrete.</span></span><span class="sig-name descname"><span class="pre">FractionProposalNetwork</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_fractions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/utils/net/discrete.html#FractionProposalNetwork"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.discrete.FractionProposalNetwork" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Fraction proposal network for FQF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_fractions</strong> – the number of factions to propose.</p></li>
<li><p><strong>embedding_dim</strong> – the dimension of the embedding/input.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Adapted from <a class="reference external" href="https://github.com/ku2482/fqf-iqn-qrdqn.pytorch/blob/master">https://github.com/ku2482/fqf-iqn-qrdqn.pytorch/blob/master</a>
/fqf_iqn_qrdqn/network.py .</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.net.discrete.FractionProposalNetwork.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs_embeddings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/utils/net/discrete.html#FractionProposalNetwork.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.discrete.FractionProposalNetwork.forward" title="Link to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tianshou.utils.net.discrete.FullQuantileFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.utils.net.discrete.</span></span><span class="sig-name descname"><span class="pre">FullQuantileFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preprocess_net</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_sizes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_cosines</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocess_net_output_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/utils/net/discrete.html#FullQuantileFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.discrete.FullQuantileFunction" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tianshou.utils.net.discrete.ImplicitQuantileNetwork" title="tianshou.utils.net.discrete.ImplicitQuantileNetwork"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImplicitQuantileNetwork</span></code></a></p>
<p>Full(y parameterized) Quantile Function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preprocess_net</strong> – a self-defined preprocess_net which output a
flattened hidden state.</p></li>
<li><p><strong>action_shape</strong> (<em>int</em>) – a sequence of int for the shape of action.</p></li>
<li><p><strong>hidden_sizes</strong> – a sequence of int for constructing the MLP after
preprocess_net. Default to empty sequence (where the MLP now contains
only a single linear layer).</p></li>
<li><p><strong>num_cosines</strong> (<em>int</em>) – the number of cosines to use for cosine embedding.
Default to 64.</p></li>
<li><p><strong>preprocess_net_output_dim</strong> (<em>int</em>) – the output dimension of
preprocess_net.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The first return value is a tuple of (quantiles, fractions, quantiles_tau),
where fractions is a Batch(taus, tau_hats, entropies).</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.net.discrete.FullQuantileFunction.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propose_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#tianshou.utils.net.discrete.FractionProposalNetwork" title="tianshou.utils.net.discrete.FractionProposalNetwork"><span class="pre">FractionProposalNetwork</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">fractions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="tianshou.data.html#tianshou.data.Batch" title="tianshou.data.batch.Batch"><span class="pre">Batch</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/utils/net/discrete.html#FullQuantileFunction.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.discrete.FullQuantileFunction.forward" title="Link to this definition">¶</a></dt>
<dd><p>Mapping: s -&gt; Q(s, *).</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tianshou.utils.net.discrete.NoisyLinear">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.utils.net.discrete.</span></span><span class="sig-name descname"><span class="pre">NoisyLinear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noisy_std</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/utils/net/discrete.html#NoisyLinear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.discrete.NoisyLinear" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Implementation of Noisy Networks. arXiv:1706.10295.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_features</strong> (<em>int</em>) – the number of input features.</p></li>
<li><p><strong>out_features</strong> (<em>int</em>) – the number of output features.</p></li>
<li><p><strong>noisy_std</strong> (<em>float</em>) – initial standard deviation of noisy linear layers.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Adapted from <a class="reference external" href="https://github.com/ku2482/fqf-iqn-qrdqn.pytorch/blob/master">https://github.com/ku2482/fqf-iqn-qrdqn.pytorch/blob/master</a>
/fqf_iqn_qrdqn/network.py .</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.net.discrete.NoisyLinear.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/net/discrete.html#NoisyLinear.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.discrete.NoisyLinear.reset" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.net.discrete.NoisyLinear.f">
<span class="sig-name descname"><span class="pre">f</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/net/discrete.html#NoisyLinear.f"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.discrete.NoisyLinear.f" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.net.discrete.NoisyLinear.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/net/discrete.html#NoisyLinear.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.discrete.NoisyLinear.sample" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.net.discrete.NoisyLinear.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/net/discrete.html#NoisyLinear.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.discrete.NoisyLinear.forward" title="Link to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tianshou.utils.net.discrete.sample_noise">
<span class="sig-prename descclassname"><span class="pre">tianshou.utils.net.discrete.</span></span><span class="sig-name descname"><span class="pre">sample_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/net/discrete.html#sample_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.discrete.sample_noise" title="Link to this definition">¶</a></dt>
<dd><p>Sample the random noises of NoisyLinear modules in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> – a PyTorch module which may have NoisyLinear submodules.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if model has at least one NoisyLinear submodule;
otherwise, False.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tianshou.utils.net.discrete.IntrinsicCuriosityModule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.utils.net.discrete.</span></span><span class="sig-name descname"><span class="pre">IntrinsicCuriosityModule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_net</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_sizes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/utils/net/discrete.html#IntrinsicCuriosityModule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.discrete.IntrinsicCuriosityModule" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Implementation of Intrinsic Curiosity Module. arXiv:1705.05363.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_net</strong> (<em>torch.nn.Module</em>) – a self-defined feature_net which output a
flattened hidden state.</p></li>
<li><p><strong>feature_dim</strong> (<em>int</em>) – input dimension of the feature net.</p></li>
<li><p><strong>action_dim</strong> (<em>int</em>) – dimension of the action space.</p></li>
<li><p><strong>hidden_sizes</strong> – hidden layer sizes for forward and inverse models.</p></li>
<li><p><strong>device</strong> – device for the module.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.net.discrete.IntrinsicCuriosityModule.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/utils/net/discrete.html#IntrinsicCuriosityModule.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.discrete.IntrinsicCuriosityModule.forward" title="Link to this definition">¶</a></dt>
<dd><p>Mapping: s1, act, s2 -&gt; mse_loss, act_hat.</p>
</dd></dl>

</dd></dl>

</section>
<section id="continuous">
<h3>Continuous<a class="headerlink" href="#continuous" title="Link to this heading">¶</a></h3>
<dl class="py class" id="module-tianshou.utils.net.continuous">
<dt class="sig sig-object py" id="tianshou.utils.net.continuous.Actor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.utils.net.continuous.</span></span><span class="sig-name descname"><span class="pre">Actor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preprocess_net</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_sizes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocess_net_output_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/utils/net/continuous.html#Actor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.continuous.Actor" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Simple actor network. Will create an actor operated in continuous     action space with structure of preprocess_net —&gt; action_shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preprocess_net</strong> – a self-defined preprocess_net which output a
flattened hidden state.</p></li>
<li><p><strong>action_shape</strong> – a sequence of int for the shape of action.</p></li>
<li><p><strong>hidden_sizes</strong> – a sequence of int for constructing the MLP after
preprocess_net. Default to empty sequence (where the MLP now contains
only a single linear layer).</p></li>
<li><p><strong>max_action</strong> (<em>float</em>) – the scale for the final action logits. Default to
1.</p></li>
<li><p><strong>preprocess_net_output_dim</strong> (<em>int</em>) – the output dimension of
preprocess_net.</p></li>
</ul>
</dd>
</dl>
<p>For advanced usage (how to customize the network), please refer to
<a class="reference internal" href="../tutorials/dqn.html#build-the-network"><span class="std std-ref">Build the Network</span></a>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Please refer to <a class="reference internal" href="#tianshou.utils.net.common.Net" title="tianshou.utils.net.common.Net"><code class="xref py py-class docutils literal notranslate"><span class="pre">Net</span></code></a> as an instance
of how preprocess_net is suggested to be defined.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.net.continuous.Actor.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/utils/net/continuous.html#Actor.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.continuous.Actor.forward" title="Link to this definition">¶</a></dt>
<dd><p>Mapping: obs -&gt; logits -&gt; action.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tianshou.utils.net.continuous.Critic">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.utils.net.continuous.</span></span><span class="sig-name descname"><span class="pre">Critic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preprocess_net:</span> <span class="pre">~torch.nn.modules.module.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_sizes:</span> <span class="pre">~typing.Sequence[int]</span> <span class="pre">=</span> <span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">~torch.device</span> <span class="pre">=</span> <span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocess_net_output_dim:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linear_layer:</span> <span class="pre">~typing.Type[~torch.nn.modules.linear.Linear]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'torch.nn.modules.linear.Linear'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flatten_input:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/utils/net/continuous.html#Critic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.continuous.Critic" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Simple critic network. Will create an actor operated in continuous     action space with structure of preprocess_net —&gt; 1(q value).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preprocess_net</strong> – a self-defined preprocess_net which output a
flattened hidden state.</p></li>
<li><p><strong>hidden_sizes</strong> – a sequence of int for constructing the MLP after
preprocess_net. Default to empty sequence (where the MLP now contains
only a single linear layer).</p></li>
<li><p><strong>preprocess_net_output_dim</strong> (<em>int</em>) – the output dimension of
preprocess_net.</p></li>
<li><p><strong>linear_layer</strong> – use this module as linear layer. Default to nn.Linear.</p></li>
<li><p><strong>flatten_input</strong> (<em>bool</em>) – whether to flatten input data for the last layer.
Default to True.</p></li>
</ul>
</dd>
</dl>
<p>For advanced usage (how to customize the network), please refer to
<a class="reference internal" href="../tutorials/dqn.html#build-the-network"><span class="std std-ref">Build the Network</span></a>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Please refer to <a class="reference internal" href="#tianshou.utils.net.common.Net" title="tianshou.utils.net.common.Net"><code class="xref py py-class docutils literal notranslate"><span class="pre">Net</span></code></a> as an instance
of how preprocess_net is suggested to be defined.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.net.continuous.Critic.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/net/continuous.html#Critic.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.continuous.Critic.forward" title="Link to this definition">¶</a></dt>
<dd><p>Mapping: (s, a) -&gt; logits -&gt; Q(s, a).</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tianshou.utils.net.continuous.ActorProb">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.utils.net.continuous.</span></span><span class="sig-name descname"><span class="pre">ActorProb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preprocess_net</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_sizes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unbounded</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conditioned_sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocess_net_output_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/utils/net/continuous.html#ActorProb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.continuous.ActorProb" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Simple actor network (output with a Gauss distribution).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preprocess_net</strong> – a self-defined preprocess_net which output a
flattened hidden state.</p></li>
<li><p><strong>action_shape</strong> – a sequence of int for the shape of action.</p></li>
<li><p><strong>hidden_sizes</strong> – a sequence of int for constructing the MLP after
preprocess_net. Default to empty sequence (where the MLP now contains
only a single linear layer).</p></li>
<li><p><strong>max_action</strong> (<em>float</em>) – the scale for the final action logits. Default to
1.</p></li>
<li><p><strong>unbounded</strong> (<em>bool</em>) – whether to apply tanh activation on final logits.
Default to False.</p></li>
<li><p><strong>conditioned_sigma</strong> (<em>bool</em>) – True when sigma is calculated from the
input, False when sigma is an independent parameter. Default to False.</p></li>
<li><p><strong>preprocess_net_output_dim</strong> (<em>int</em>) – the output dimension of
preprocess_net.</p></li>
</ul>
</dd>
</dl>
<p>For advanced usage (how to customize the network), please refer to
<a class="reference internal" href="../tutorials/dqn.html#build-the-network"><span class="std std-ref">Build the Network</span></a>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Please refer to <a class="reference internal" href="#tianshou.utils.net.common.Net" title="tianshou.utils.net.common.Net"><code class="xref py py-class docutils literal notranslate"><span class="pre">Net</span></code></a> as an instance
of how preprocess_net is suggested to be defined.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.net.continuous.ActorProb.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/utils/net/continuous.html#ActorProb.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.continuous.ActorProb.forward" title="Link to this definition">¶</a></dt>
<dd><p>Mapping: obs -&gt; logits -&gt; (mu, sigma).</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tianshou.utils.net.continuous.RecurrentActorProb">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.utils.net.continuous.</span></span><span class="sig-name descname"><span class="pre">RecurrentActorProb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_layer_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unbounded</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conditioned_sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/utils/net/continuous.html#RecurrentActorProb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.continuous.RecurrentActorProb" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Recurrent version of ActorProb.</p>
<p>For advanced usage (how to customize the network), please refer to
<a class="reference internal" href="../tutorials/dqn.html#build-the-network"><span class="std std-ref">Build the Network</span></a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.net.continuous.RecurrentActorProb.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/utils/net/continuous.html#RecurrentActorProb.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.continuous.RecurrentActorProb.forward" title="Link to this definition">¶</a></dt>
<dd><p>Almost the same as <a class="reference internal" href="#tianshou.utils.net.common.Recurrent" title="tianshou.utils.net.common.Recurrent"><code class="xref py py-class docutils literal notranslate"><span class="pre">Recurrent</span></code></a>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tianshou.utils.net.continuous.RecurrentCritic">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.utils.net.continuous.</span></span><span class="sig-name descname"><span class="pre">RecurrentCritic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_layer_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/utils/net/continuous.html#RecurrentCritic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.continuous.RecurrentCritic" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Recurrent version of Critic.</p>
<p>For advanced usage (how to customize the network), please refer to
<a class="reference internal" href="../tutorials/dqn.html#build-the-network"><span class="std std-ref">Build the Network</span></a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.net.continuous.RecurrentCritic.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/net/continuous.html#RecurrentCritic.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.continuous.RecurrentCritic.forward" title="Link to this definition">¶</a></dt>
<dd><p>Almost the same as <a class="reference internal" href="#tianshou.utils.net.common.Recurrent" title="tianshou.utils.net.common.Recurrent"><code class="xref py py-class docutils literal notranslate"><span class="pre">Recurrent</span></code></a>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tianshou.utils.net.continuous.Perturbation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.utils.net.continuous.</span></span><span class="sig-name descname"><span class="pre">Perturbation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preprocess_net</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/utils/net/continuous.html#Perturbation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.continuous.Perturbation" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Implementation of perturbation network in BCQ algorithm. Given a state and     action, it can generate perturbed action.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preprocess_net</strong> (<em>torch.nn.Module</em>) – a self-defined preprocess_net which output a
flattened hidden state.</p></li>
<li><p><strong>max_action</strong> (<em>float</em>) – the maximum value of each dimension of action.</p></li>
<li><p><strong>device</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>int</em><em>, </em><em>torch.device</em><em>]</em>) – which device to create this model on.
Default to cpu.</p></li>
<li><p><strong>phi</strong> (<em>float</em>) – max perturbation parameter for BCQ. Default to 0.05.</p></li>
</ul>
</dd>
</dl>
<p>For advanced usage (how to customize the network), please refer to
<a class="reference internal" href="../tutorials/dqn.html#build-the-network"><span class="std std-ref">Build the Network</span></a>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>You can refer to <cite>examples/offline/offline_bcq.py</cite> to see how to use it.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.net.continuous.Perturbation.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/net/continuous.html#Perturbation.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.continuous.Perturbation.forward" title="Link to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tianshou.utils.net.continuous.VAE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.utils.net.continuous.</span></span><span class="sig-name descname"><span class="pre">VAE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/utils/net/continuous.html#VAE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.continuous.VAE" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Implementation of VAE. It models the distribution of action. Given a     state, it can generate actions similar to those in batch. It is used     in BCQ algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>encoder</strong> (<em>torch.nn.Module</em>) – the encoder in VAE. Its input_dim must be
state_dim + action_dim, and output_dim must be hidden_dim.</p></li>
<li><p><strong>decoder</strong> (<em>torch.nn.Module</em>) – the decoder in VAE. Its input_dim must be
state_dim + latent_dim, and output_dim must be action_dim.</p></li>
<li><p><strong>hidden_dim</strong> (<em>int</em>) – the size of the last linear-layer in encoder.</p></li>
<li><p><strong>latent_dim</strong> (<em>int</em>) – the size of latent layer.</p></li>
<li><p><strong>max_action</strong> (<em>float</em>) – the maximum value of each dimension of action.</p></li>
<li><p><strong>device</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>torch.device</em><em>]</em>) – which device to create this model on.
Default to “cpu”.</p></li>
</ul>
</dd>
</dl>
<p>For advanced usage (how to customize the network), please refer to
<a class="reference internal" href="../tutorials/dqn.html#build-the-network"><span class="std std-ref">Build the Network</span></a>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>You can refer to <cite>examples/offline/offline_bcq.py</cite> to see how to use it.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.net.continuous.VAE.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/utils/net/continuous.html#VAE.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.continuous.VAE.forward" title="Link to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.utils.net.continuous.VAE.decode">
<span class="sig-name descname"><span class="pre">decode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tianshou/utils/net/continuous.html#VAE.decode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.utils.net.continuous.VAE.decode" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tianshou.exploration.html" class="btn btn-neutral float-left" title="tianshou.exploration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../contributing.html" class="btn btn-neutral float-right" title="Contributing to Tianshou" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Tianshou contributors..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>