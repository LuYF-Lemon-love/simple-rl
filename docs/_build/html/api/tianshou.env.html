<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>tianshou.env &mdash; Tianshou 0.5.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/style.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/documentation_options.js?v=b9afe91b"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="https://cdn.jsdelivr.net/npm/vega@5.20.2"></script>
        <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.1.0"></script>
        <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.17.0"></script>
        <script src="../_static/js/copybutton.js?v=7db002fe"></script>
        <script src="../_static/js/benchmark.js?v=1091b9f3"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="tianshou.policy" href="tianshou.policy.html" />
    <link rel="prev" title="tianshou.data" href="tianshou.data.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Tianshou
              <img src="../_static/tianshou-logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.5.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/get_started.html">Get Started with Jupyter Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/dqn.html">Deep Q Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/concepts.html">Basic concepts in Tianshou</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/batch.html">Understand Batch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/tictactoe.html">Multi-Agent RL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/logger.html">Logging Experiments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/benchmark.html">Benchmark</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/cheatsheet.html">Cheat Sheet</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Docs</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tianshou.data.html">tianshou.data</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">tianshou.env</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#vectorenv">VectorEnv</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#basevectorenv">BaseVectorEnv</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.env.BaseVectorEnv"><code class="docutils literal notranslate"><span class="pre">BaseVectorEnv</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#dummyvectorenv">DummyVectorEnv</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.env.DummyVectorEnv"><code class="docutils literal notranslate"><span class="pre">DummyVectorEnv</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#subprocvectorenv">SubprocVectorEnv</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.env.SubprocVectorEnv"><code class="docutils literal notranslate"><span class="pre">SubprocVectorEnv</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#shmemvectorenv">ShmemVectorEnv</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.env.ShmemVectorEnv"><code class="docutils literal notranslate"><span class="pre">ShmemVectorEnv</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#rayvectorenv">RayVectorEnv</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.env.RayVectorEnv"><code class="docutils literal notranslate"><span class="pre">RayVectorEnv</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#wrapper">Wrapper</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#continuoustodiscrete">ContinuousToDiscrete</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.env.ContinuousToDiscrete"><code class="docutils literal notranslate"><span class="pre">ContinuousToDiscrete</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vectorenvwrapper">VectorEnvWrapper</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.env.VectorEnvWrapper"><code class="docutils literal notranslate"><span class="pre">VectorEnvWrapper</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vectorenvnormobs">VectorEnvNormObs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.env.VectorEnvNormObs"><code class="docutils literal notranslate"><span class="pre">VectorEnvNormObs</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#worker">Worker</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#envworker">EnvWorker</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.env.worker.EnvWorker"><code class="docutils literal notranslate"><span class="pre">EnvWorker</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#dummyenvworker">DummyEnvWorker</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.env.worker.DummyEnvWorker"><code class="docutils literal notranslate"><span class="pre">DummyEnvWorker</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#subprocenvworker">SubprocEnvWorker</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.env.worker.SubprocEnvWorker"><code class="docutils literal notranslate"><span class="pre">SubprocEnvWorker</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#rayenvworker">RayEnvWorker</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.env.worker.RayEnvWorker"><code class="docutils literal notranslate"><span class="pre">RayEnvWorker</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#utils">Utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pettingzooenv">PettingZooEnv</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.env.PettingZooEnv"><code class="docutils literal notranslate"><span class="pre">PettingZooEnv</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tianshou.policy.html">tianshou.policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="tianshou.trainer.html">tianshou.trainer</a></li>
<li class="toctree-l1"><a class="reference internal" href="tianshou.exploration.html">tianshou.exploration</a></li>
<li class="toctree-l1"><a class="reference internal" href="tianshou.utils.html">tianshou.utils</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing to Tianshou</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributor.html">Contributor</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Tianshou</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">tianshou.env</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/tianshou.env.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tianshou-env">
<h1>tianshou.env<a class="headerlink" href="#tianshou-env" title="Link to this heading">¶</a></h1>
<section id="vectorenv">
<h2>VectorEnv<a class="headerlink" href="#vectorenv" title="Link to this heading">¶</a></h2>
<section id="basevectorenv">
<h3>BaseVectorEnv<a class="headerlink" href="#basevectorenv" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tianshou.env.BaseVectorEnv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.env.</span></span><span class="sig-name descname"><span class="pre">BaseVectorEnv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_fns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Env</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#tianshou.env.PettingZooEnv" title="tianshou.env.pettingzoo_env.PettingZooEnv"><span class="pre">PettingZooEnv</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">worker_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Env</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#tianshou.env.worker.EnvWorker" title="tianshou.env.worker.base.EnvWorker"><span class="pre">EnvWorker</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wait_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/env/venvs.html#BaseVectorEnv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.BaseVectorEnv" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for vectorized environments.</p>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">env_num</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">envs</span> <span class="o">=</span> <span class="n">DummyVectorEnv</span><span class="p">([</span><span class="k">lambda</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="n">task</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">env_num</span><span class="p">)])</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">envs</span><span class="p">)</span> <span class="o">==</span> <span class="n">env_num</span>
</pre></div>
</div>
<p>It accepts a list of environment generators. In other words, an environment
generator <code class="docutils literal notranslate"><span class="pre">efn</span></code> of a specific task means that <code class="docutils literal notranslate"><span class="pre">efn()</span></code> returns the
environment of the given task, for example, <code class="docutils literal notranslate"><span class="pre">gym.make(task)</span></code>.</p>
<p>All of the VectorEnv must inherit <a class="reference internal" href="#tianshou.env.BaseVectorEnv" title="tianshou.env.BaseVectorEnv"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseVectorEnv</span></code></a>.
Here are some other usages:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">envs</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># which is equal to the next line</span>
<span class="n">envs</span><span class="o">.</span><span class="n">seed</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>  <span class="c1"># set specific seed for each env</span>
<span class="n">obs</span> <span class="o">=</span> <span class="n">envs</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>  <span class="c1"># reset all environments</span>
<span class="n">obs</span> <span class="o">=</span> <span class="n">envs</span><span class="o">.</span><span class="n">reset</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>  <span class="c1"># reset 3 specific environments</span>
<span class="n">obs</span><span class="p">,</span> <span class="n">rew</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">envs</span><span class="o">.</span><span class="n">step</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">8</span><span class="p">)</span>  <span class="c1"># step synchronously</span>
<span class="n">envs</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>  <span class="c1"># render all environments</span>
<span class="n">envs</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>  <span class="c1"># close all environments</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you use your own environment, please make sure the <code class="docutils literal notranslate"><span class="pre">seed</span></code> method
is set up properly, e.g.,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">seed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="p">):</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
</pre></div>
</div>
<p>Otherwise, the outputs of these envs may be the same with each other.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_fns</strong> – a list of callable envs, <code class="docutils literal notranslate"><span class="pre">env_fns[i]()</span></code> generates the i-th env.</p></li>
<li><p><strong>worker_fn</strong> – a callable worker, <code class="docutils literal notranslate"><span class="pre">worker_fn(env_fns[i])</span></code> generates a
worker which contains the i-th env.</p></li>
<li><p><strong>wait_num</strong> (<em>int</em>) – use in asynchronous simulation if the time cost of
<code class="docutils literal notranslate"><span class="pre">env.step</span></code> varies with time and synchronously waiting for all
environments to finish a step is time-wasting. In that case, we can
return when <code class="docutils literal notranslate"><span class="pre">wait_num</span></code> environments finish a step and keep on
simulation in these environments. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, asynchronous simulation
is disabled; else, <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">&lt;=</span> <span class="pre">wait_num</span> <span class="pre">&lt;=</span> <span class="pre">env_num</span></code>.</p></li>
<li><p><strong>timeout</strong> (<em>float</em>) – use in asynchronous simulation same as above, in each
vectorized step it only deal with those environments spending time
within <code class="docutils literal notranslate"><span class="pre">timeout</span></code> seconds.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.BaseVectorEnv.__len__">
<span class="sig-name descname"><span class="pre">__len__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="../_modules/tianshou/env/venvs.html#BaseVectorEnv.__len__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.BaseVectorEnv.__len__" title="Link to this definition">¶</a></dt>
<dd><p>Return len(self), which is the number of environments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.BaseVectorEnv.get_env_attr">
<span class="sig-name descname"><span class="pre">get_env_attr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/env/venvs.html#BaseVectorEnv.get_env_attr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.BaseVectorEnv.get_env_attr" title="Link to this definition">¶</a></dt>
<dd><p>Get an attribute from the underlying environments.</p>
<p>If id is an int, retrieve the attribute denoted by key from the environment
underlying the worker at index id. The result is returned as a list with one
element. Otherwise, retrieve the attribute for all workers at indices id and
return a list that is ordered correspondingly to id.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>str</em>) – The key of the desired attribute.</p></li>
<li><p><strong>id</strong> – Indice(s) of the desired worker(s). Default to None for all env_id.</p></li>
</ul>
</dd>
<dt class="field-even">Return list<span class="colon">:</span></dt>
<dd class="field-even"><p>The list of environment attributes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.BaseVectorEnv.set_env_attr">
<span class="sig-name descname"><span class="pre">set_env_attr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/env/venvs.html#BaseVectorEnv.set_env_attr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.BaseVectorEnv.set_env_attr" title="Link to this definition">¶</a></dt>
<dd><p>Set an attribute in the underlying environments.</p>
<p>If id is an int, set the attribute denoted by key from the environment
underlying the worker at index id to value.
Otherwise, set the attribute for all workers at indices id.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>str</em>) – The key of the desired attribute.</p></li>
<li><p><strong>value</strong> (<em>Any</em>) – The new value of the attribute.</p></li>
<li><p><strong>id</strong> – Indice(s) of the desired worker(s). Default to None for all env_id.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.BaseVectorEnv.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/env/venvs.html#BaseVectorEnv.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.BaseVectorEnv.reset" title="Link to this definition">¶</a></dt>
<dd><p>Reset the state of some envs and return initial observations.</p>
<p>If id is None, reset the state of all the environments and return
initial observations, otherwise reset the specific environments with
the given id, either an int or a list.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.BaseVectorEnv.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/env/venvs.html#BaseVectorEnv.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.BaseVectorEnv.step" title="Link to this definition">¶</a></dt>
<dd><p>Run one timestep of some environments’ dynamics.</p>
<p>If id is None, run one timestep of all the environments’ dynamics;
otherwise run one timestep for some environments with given id,  either
an int or a list. When the end of episode is reached, you are
responsible for calling reset(id) to reset this environment’s state.</p>
<p>Accept a batch of action and return a tuple (batch_obs, batch_rew,
batch_done, batch_info) in numpy format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>action</strong> (<em>numpy.ndarray</em>) – a batch of action provided by the agent.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A tuple consisting of either:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">obs</span></code> a numpy.ndarray, the agent’s observation of current environments</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rew</span></code> a numpy.ndarray, the amount of rewards returned after                 previous actions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">terminated</span></code> a numpy.ndarray, whether these episodes have been                 terminated</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">truncated</span></code> a numpy.ndarray, whether these episodes have been truncated</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">info</span></code> a numpy.ndarray, contains auxiliary diagnostic                 information (helpful for debugging, and sometimes learning)</p></li>
</ul>
</p>
</dd>
</dl>
<p>For the async simulation:</p>
<p>Provide the given action to the environments. The action sequence
should correspond to the <code class="docutils literal notranslate"><span class="pre">id</span></code> argument, and the <code class="docutils literal notranslate"><span class="pre">id</span></code> argument
should be a subset of the <code class="docutils literal notranslate"><span class="pre">env_id</span></code> in the last returned <code class="docutils literal notranslate"><span class="pre">info</span></code>
(initially they are env_ids of all the environments). If action is
None, fetch unfinished step() calls instead.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.BaseVectorEnv.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/env/venvs.html#BaseVectorEnv.seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.BaseVectorEnv.seed" title="Link to this definition">¶</a></dt>
<dd><p>Set the seed for all environments.</p>
<p>Accept <code class="docutils literal notranslate"><span class="pre">None</span></code>, an int (which will extend <code class="docutils literal notranslate"><span class="pre">i</span></code> to
<code class="docutils literal notranslate"><span class="pre">[i,</span> <span class="pre">i</span> <span class="pre">+</span> <span class="pre">1,</span> <span class="pre">i</span> <span class="pre">+</span> <span class="pre">2,</span> <span class="pre">...]</span></code>) or a list.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The list of seeds used in this env’s random number generators.
The first value in the list should be the “main” seed, or the value
which a reproducer pass to “seed”.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.BaseVectorEnv.render">
<span class="sig-name descname"><span class="pre">render</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/env/venvs.html#BaseVectorEnv.render"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.BaseVectorEnv.render" title="Link to this definition">¶</a></dt>
<dd><p>Render all of the environments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.BaseVectorEnv.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/env/venvs.html#BaseVectorEnv.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.BaseVectorEnv.close" title="Link to this definition">¶</a></dt>
<dd><p>Close all of the environments.</p>
<p>This function will be called only once (if not, it will be called during
garbage collected). This way, <code class="docutils literal notranslate"><span class="pre">close</span></code> of all workers can be assured.</p>
</dd></dl>

</dd></dl>

</section>
<section id="dummyvectorenv">
<h3>DummyVectorEnv<a class="headerlink" href="#dummyvectorenv" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tianshou.env.DummyVectorEnv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.env.</span></span><span class="sig-name descname"><span class="pre">DummyVectorEnv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_fns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Env</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#tianshou.env.PettingZooEnv" title="tianshou.env.pettingzoo_env.PettingZooEnv"><span class="pre">PettingZooEnv</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/env/venvs.html#DummyVectorEnv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.DummyVectorEnv" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tianshou.env.BaseVectorEnv" title="tianshou.env.venvs.BaseVectorEnv"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseVectorEnv</span></code></a></p>
<p>Dummy vectorized environment wrapper, implemented in for-loop.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Please refer to <a class="reference internal" href="#tianshou.env.BaseVectorEnv" title="tianshou.env.BaseVectorEnv"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseVectorEnv</span></code></a> for other APIs’ usage.</p>
</div>
</dd></dl>

</section>
<section id="subprocvectorenv">
<h3>SubprocVectorEnv<a class="headerlink" href="#subprocvectorenv" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tianshou.env.SubprocVectorEnv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.env.</span></span><span class="sig-name descname"><span class="pre">SubprocVectorEnv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_fns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Env</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#tianshou.env.PettingZooEnv" title="tianshou.env.pettingzoo_env.PettingZooEnv"><span class="pre">PettingZooEnv</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/env/venvs.html#SubprocVectorEnv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.SubprocVectorEnv" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tianshou.env.BaseVectorEnv" title="tianshou.env.venvs.BaseVectorEnv"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseVectorEnv</span></code></a></p>
<p>Vectorized environment wrapper based on subprocess.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Please refer to <a class="reference internal" href="#tianshou.env.BaseVectorEnv" title="tianshou.env.BaseVectorEnv"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseVectorEnv</span></code></a> for other APIs’ usage.</p>
</div>
</dd></dl>

</section>
<section id="shmemvectorenv">
<h3>ShmemVectorEnv<a class="headerlink" href="#shmemvectorenv" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tianshou.env.ShmemVectorEnv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.env.</span></span><span class="sig-name descname"><span class="pre">ShmemVectorEnv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_fns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Env</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#tianshou.env.PettingZooEnv" title="tianshou.env.pettingzoo_env.PettingZooEnv"><span class="pre">PettingZooEnv</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/env/venvs.html#ShmemVectorEnv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.ShmemVectorEnv" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tianshou.env.BaseVectorEnv" title="tianshou.env.venvs.BaseVectorEnv"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseVectorEnv</span></code></a></p>
<p>Optimized SubprocVectorEnv with shared buffers to exchange observations.</p>
<p>ShmemVectorEnv has exactly the same API as SubprocVectorEnv.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Please refer to <a class="reference internal" href="#tianshou.env.BaseVectorEnv" title="tianshou.env.BaseVectorEnv"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseVectorEnv</span></code></a> for other APIs’ usage.</p>
</div>
</dd></dl>

</section>
<section id="rayvectorenv">
<h3>RayVectorEnv<a class="headerlink" href="#rayvectorenv" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tianshou.env.RayVectorEnv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.env.</span></span><span class="sig-name descname"><span class="pre">RayVectorEnv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_fns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Env</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#tianshou.env.PettingZooEnv" title="tianshou.env.pettingzoo_env.PettingZooEnv"><span class="pre">PettingZooEnv</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/env/venvs.html#RayVectorEnv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.RayVectorEnv" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tianshou.env.BaseVectorEnv" title="tianshou.env.venvs.BaseVectorEnv"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseVectorEnv</span></code></a></p>
<p>Vectorized environment wrapper based on ray.</p>
<p>This is a choice to run distributed environments in a cluster.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Please refer to <a class="reference internal" href="#tianshou.env.BaseVectorEnv" title="tianshou.env.BaseVectorEnv"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseVectorEnv</span></code></a> for other APIs’ usage.</p>
</div>
</dd></dl>

</section>
</section>
<section id="wrapper">
<h2>Wrapper<a class="headerlink" href="#wrapper" title="Link to this heading">¶</a></h2>
<section id="continuoustodiscrete">
<h3>ContinuousToDiscrete<a class="headerlink" href="#continuoustodiscrete" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tianshou.env.ContinuousToDiscrete">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.env.</span></span><span class="sig-name descname"><span class="pre">ContinuousToDiscrete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_per_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/env/gym_wrappers.html#ContinuousToDiscrete"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.ContinuousToDiscrete" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ActionWrapper</span></code></p>
<p>Gym environment wrapper to take discrete action in a continuous environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> (<em>gym.Env</em>) – gym environment with continuous action space.</p></li>
<li><p><strong>action_per_dim</strong> (<em>int</em>) – number of discrete actions in each dimension
of the action space.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.ContinuousToDiscrete.action">
<span class="sig-name descname"><span class="pre">action</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/tianshou/env/gym_wrappers.html#ContinuousToDiscrete.action"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.ContinuousToDiscrete.action" title="Link to this definition">¶</a></dt>
<dd><p>Returns a modified action before <code class="xref py py-meth docutils literal notranslate"><span class="pre">env.step()</span></code> is called.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>action: The original <code class="xref py py-meth docutils literal notranslate"><span class="pre">step()</span></code> actions</p>
</dd>
<dt>Returns:</dt><dd><p>The modified actions</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="vectorenvwrapper">
<h3>VectorEnvWrapper<a class="headerlink" href="#vectorenvwrapper" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tianshou.env.VectorEnvWrapper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.env.</span></span><span class="sig-name descname"><span class="pre">VectorEnvWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">venv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#tianshou.env.BaseVectorEnv" title="tianshou.env.venvs.BaseVectorEnv"><span class="pre">BaseVectorEnv</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/env/venv_wrappers.html#VectorEnvWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.VectorEnvWrapper" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tianshou.env.BaseVectorEnv" title="tianshou.env.venvs.BaseVectorEnv"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseVectorEnv</span></code></a></p>
<p>Base class for vectorized environments wrapper.</p>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.VectorEnvWrapper.__len__">
<span class="sig-name descname"><span class="pre">__len__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="../_modules/tianshou/env/venv_wrappers.html#VectorEnvWrapper.__len__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.VectorEnvWrapper.__len__" title="Link to this definition">¶</a></dt>
<dd><p>Return len(self), which is the number of environments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.VectorEnvWrapper.get_env_attr">
<span class="sig-name descname"><span class="pre">get_env_attr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/env/venv_wrappers.html#VectorEnvWrapper.get_env_attr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.VectorEnvWrapper.get_env_attr" title="Link to this definition">¶</a></dt>
<dd><p>Get an attribute from the underlying environments.</p>
<p>If id is an int, retrieve the attribute denoted by key from the environment
underlying the worker at index id. The result is returned as a list with one
element. Otherwise, retrieve the attribute for all workers at indices id and
return a list that is ordered correspondingly to id.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>str</em>) – The key of the desired attribute.</p></li>
<li><p><strong>id</strong> – Indice(s) of the desired worker(s). Default to None for all env_id.</p></li>
</ul>
</dd>
<dt class="field-even">Return list<span class="colon">:</span></dt>
<dd class="field-even"><p>The list of environment attributes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.VectorEnvWrapper.set_env_attr">
<span class="sig-name descname"><span class="pre">set_env_attr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/env/venv_wrappers.html#VectorEnvWrapper.set_env_attr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.VectorEnvWrapper.set_env_attr" title="Link to this definition">¶</a></dt>
<dd><p>Set an attribute in the underlying environments.</p>
<p>If id is an int, set the attribute denoted by key from the environment
underlying the worker at index id to value.
Otherwise, set the attribute for all workers at indices id.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>str</em>) – The key of the desired attribute.</p></li>
<li><p><strong>value</strong> (<em>Any</em>) – The new value of the attribute.</p></li>
<li><p><strong>id</strong> – Indice(s) of the desired worker(s). Default to None for all env_id.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.VectorEnvWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/env/venv_wrappers.html#VectorEnvWrapper.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.VectorEnvWrapper.reset" title="Link to this definition">¶</a></dt>
<dd><p>Reset the state of some envs and return initial observations.</p>
<p>If id is None, reset the state of all the environments and return
initial observations, otherwise reset the specific environments with
the given id, either an int or a list.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.VectorEnvWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/env/venv_wrappers.html#VectorEnvWrapper.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.VectorEnvWrapper.step" title="Link to this definition">¶</a></dt>
<dd><p>Run one timestep of some environments’ dynamics.</p>
<p>If id is None, run one timestep of all the environments’ dynamics;
otherwise run one timestep for some environments with given id,  either
an int or a list. When the end of episode is reached, you are
responsible for calling reset(id) to reset this environment’s state.</p>
<p>Accept a batch of action and return a tuple (batch_obs, batch_rew,
batch_done, batch_info) in numpy format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>action</strong> (<em>numpy.ndarray</em>) – a batch of action provided by the agent.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A tuple consisting of either:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">obs</span></code> a numpy.ndarray, the agent’s observation of current environments</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rew</span></code> a numpy.ndarray, the amount of rewards returned after                 previous actions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">terminated</span></code> a numpy.ndarray, whether these episodes have been                 terminated</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">truncated</span></code> a numpy.ndarray, whether these episodes have been truncated</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">info</span></code> a numpy.ndarray, contains auxiliary diagnostic                 information (helpful for debugging, and sometimes learning)</p></li>
</ul>
</p>
</dd>
</dl>
<p>For the async simulation:</p>
<p>Provide the given action to the environments. The action sequence
should correspond to the <code class="docutils literal notranslate"><span class="pre">id</span></code> argument, and the <code class="docutils literal notranslate"><span class="pre">id</span></code> argument
should be a subset of the <code class="docutils literal notranslate"><span class="pre">env_id</span></code> in the last returned <code class="docutils literal notranslate"><span class="pre">info</span></code>
(initially they are env_ids of all the environments). If action is
None, fetch unfinished step() calls instead.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.VectorEnvWrapper.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/env/venv_wrappers.html#VectorEnvWrapper.seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.VectorEnvWrapper.seed" title="Link to this definition">¶</a></dt>
<dd><p>Set the seed for all environments.</p>
<p>Accept <code class="docutils literal notranslate"><span class="pre">None</span></code>, an int (which will extend <code class="docutils literal notranslate"><span class="pre">i</span></code> to
<code class="docutils literal notranslate"><span class="pre">[i,</span> <span class="pre">i</span> <span class="pre">+</span> <span class="pre">1,</span> <span class="pre">i</span> <span class="pre">+</span> <span class="pre">2,</span> <span class="pre">...]</span></code>) or a list.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The list of seeds used in this env’s random number generators.
The first value in the list should be the “main” seed, or the value
which a reproducer pass to “seed”.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.VectorEnvWrapper.render">
<span class="sig-name descname"><span class="pre">render</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/env/venv_wrappers.html#VectorEnvWrapper.render"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.VectorEnvWrapper.render" title="Link to this definition">¶</a></dt>
<dd><p>Render all of the environments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.VectorEnvWrapper.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/env/venv_wrappers.html#VectorEnvWrapper.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.VectorEnvWrapper.close" title="Link to this definition">¶</a></dt>
<dd><p>Close all of the environments.</p>
<p>This function will be called only once (if not, it will be called during
garbage collected). This way, <code class="docutils literal notranslate"><span class="pre">close</span></code> of all workers can be assured.</p>
</dd></dl>

</dd></dl>

</section>
<section id="vectorenvnormobs">
<h3>VectorEnvNormObs<a class="headerlink" href="#vectorenvnormobs" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tianshou.env.VectorEnvNormObs">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.env.</span></span><span class="sig-name descname"><span class="pre">VectorEnvNormObs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">venv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#tianshou.env.BaseVectorEnv" title="tianshou.env.venvs.BaseVectorEnv"><span class="pre">BaseVectorEnv</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_obs_rms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/env/venv_wrappers.html#VectorEnvNormObs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.VectorEnvNormObs" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tianshou.env.VectorEnvWrapper" title="tianshou.env.venv_wrappers.VectorEnvWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">VectorEnvWrapper</span></code></a></p>
<p>An observation normalization wrapper for vectorized environments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>update_obs_rms</strong> (<em>bool</em>) – whether to update obs_rms. Default to True.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.VectorEnvNormObs.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/env/venv_wrappers.html#VectorEnvNormObs.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.VectorEnvNormObs.reset" title="Link to this definition">¶</a></dt>
<dd><p>Reset the state of some envs and return initial observations.</p>
<p>If id is None, reset the state of all the environments and return
initial observations, otherwise reset the specific environments with
the given id, either an int or a list.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.VectorEnvNormObs.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/env/venv_wrappers.html#VectorEnvNormObs.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.VectorEnvNormObs.step" title="Link to this definition">¶</a></dt>
<dd><p>Run one timestep of some environments’ dynamics.</p>
<p>If id is None, run one timestep of all the environments’ dynamics;
otherwise run one timestep for some environments with given id,  either
an int or a list. When the end of episode is reached, you are
responsible for calling reset(id) to reset this environment’s state.</p>
<p>Accept a batch of action and return a tuple (batch_obs, batch_rew,
batch_done, batch_info) in numpy format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>action</strong> (<em>numpy.ndarray</em>) – a batch of action provided by the agent.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A tuple consisting of either:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">obs</span></code> a numpy.ndarray, the agent’s observation of current environments</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rew</span></code> a numpy.ndarray, the amount of rewards returned after                 previous actions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">terminated</span></code> a numpy.ndarray, whether these episodes have been                 terminated</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">truncated</span></code> a numpy.ndarray, whether these episodes have been truncated</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">info</span></code> a numpy.ndarray, contains auxiliary diagnostic                 information (helpful for debugging, and sometimes learning)</p></li>
</ul>
</p>
</dd>
</dl>
<p>For the async simulation:</p>
<p>Provide the given action to the environments. The action sequence
should correspond to the <code class="docutils literal notranslate"><span class="pre">id</span></code> argument, and the <code class="docutils literal notranslate"><span class="pre">id</span></code> argument
should be a subset of the <code class="docutils literal notranslate"><span class="pre">env_id</span></code> in the last returned <code class="docutils literal notranslate"><span class="pre">info</span></code>
(initially they are env_ids of all the environments). If action is
None, fetch unfinished step() calls instead.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.VectorEnvNormObs.set_obs_rms">
<span class="sig-name descname"><span class="pre">set_obs_rms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs_rms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="tianshou.utils.html#tianshou.utils.RunningMeanStd" title="tianshou.utils.statistics.RunningMeanStd"><span class="pre">RunningMeanStd</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/env/venv_wrappers.html#VectorEnvNormObs.set_obs_rms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.VectorEnvNormObs.set_obs_rms" title="Link to this definition">¶</a></dt>
<dd><p>Set with given observation running mean/std.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.VectorEnvNormObs.get_obs_rms">
<span class="sig-name descname"><span class="pre">get_obs_rms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="tianshou.utils.html#tianshou.utils.RunningMeanStd" title="tianshou.utils.statistics.RunningMeanStd"><span class="pre">RunningMeanStd</span></a></span></span><a class="reference internal" href="../_modules/tianshou/env/venv_wrappers.html#VectorEnvNormObs.get_obs_rms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.VectorEnvNormObs.get_obs_rms" title="Link to this definition">¶</a></dt>
<dd><p>Return observation running mean/std.</p>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="worker">
<h2>Worker<a class="headerlink" href="#worker" title="Link to this heading">¶</a></h2>
<section id="envworker">
<h3>EnvWorker<a class="headerlink" href="#envworker" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tianshou.env.worker.EnvWorker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.env.worker.</span></span><span class="sig-name descname"><span class="pre">EnvWorker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Env</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/env/worker/base.html#EnvWorker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.EnvWorker" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>An abstract worker for an environment.</p>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.EnvWorker.get_env_attr">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_env_attr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/base.html#EnvWorker.get_env_attr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.EnvWorker.get_env_attr" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.EnvWorker.set_env_attr">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_env_attr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/base.html#EnvWorker.set_env_attr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.EnvWorker.set_env_attr" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.EnvWorker.send">
<span class="sig-name descname"><span class="pre">send</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/base.html#EnvWorker.send"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.EnvWorker.send" title="Link to this definition">¶</a></dt>
<dd><p>Send action signal to low-level worker.</p>
<p>When action is None, it indicates sending “reset” signal; otherwise
it indicates “step” signal. The paired return value from “recv”
function is determined by such kind of different signal.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.EnvWorker.recv">
<span class="sig-name descname"><span class="pre">recv</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/base.html#EnvWorker.recv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.EnvWorker.recv" title="Link to this definition">¶</a></dt>
<dd><p>Receive result from low-level worker.</p>
<p>If the last “send” function sends a NULL action, it only returns a
single observation; otherwise it returns a tuple of (obs, rew, done,
info) or (obs, rew, terminated, truncated, info), based on whether
the environment is using the old step API or the new one.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.EnvWorker.reset">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/base.html#EnvWorker.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.EnvWorker.reset" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.EnvWorker.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/base.html#EnvWorker.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.EnvWorker.step" title="Link to this definition">¶</a></dt>
<dd><p>Perform one timestep of the environment’s dynamic.</p>
<p>“send” and “recv” are coupled in sync simulation, so users only call
“step” function. But they can be called separately in async
simulation, i.e. someone calls “send” first, and calls “recv” later.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.EnvWorker.wait">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">wait</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#tianshou.env.worker.EnvWorker" title="tianshou.env.worker.base.EnvWorker"><span class="pre">EnvWorker</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wait_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#tianshou.env.worker.EnvWorker" title="tianshou.env.worker.base.EnvWorker"><span class="pre">EnvWorker</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/base.html#EnvWorker.wait"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.EnvWorker.wait" title="Link to this definition">¶</a></dt>
<dd><p>Given a list of workers, return those ready ones.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.EnvWorker.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/base.html#EnvWorker.seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.EnvWorker.seed" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.EnvWorker.render">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">render</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/base.html#EnvWorker.render"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.EnvWorker.render" title="Link to this definition">¶</a></dt>
<dd><p>Render the environment.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.EnvWorker.close_env">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">close_env</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/base.html#EnvWorker.close_env"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.EnvWorker.close_env" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.EnvWorker.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/base.html#EnvWorker.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.EnvWorker.close" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="dummyenvworker">
<h3>DummyEnvWorker<a class="headerlink" href="#dummyenvworker" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tianshou.env.worker.DummyEnvWorker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.env.worker.</span></span><span class="sig-name descname"><span class="pre">DummyEnvWorker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Env</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/env/worker/dummy.html#DummyEnvWorker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.DummyEnvWorker" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tianshou.env.worker.EnvWorker" title="tianshou.env.worker.base.EnvWorker"><code class="xref py py-class docutils literal notranslate"><span class="pre">EnvWorker</span></code></a></p>
<p>Dummy worker used in sequential vector environments.</p>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.DummyEnvWorker.get_env_attr">
<span class="sig-name descname"><span class="pre">get_env_attr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/dummy.html#DummyEnvWorker.get_env_attr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.DummyEnvWorker.get_env_attr" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.DummyEnvWorker.set_env_attr">
<span class="sig-name descname"><span class="pre">set_env_attr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/dummy.html#DummyEnvWorker.set_env_attr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.DummyEnvWorker.set_env_attr" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.DummyEnvWorker.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/dummy.html#DummyEnvWorker.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.DummyEnvWorker.reset" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.DummyEnvWorker.wait">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">wait</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#tianshou.env.worker.DummyEnvWorker" title="tianshou.env.worker.dummy.DummyEnvWorker"><span class="pre">DummyEnvWorker</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wait_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#tianshou.env.worker.DummyEnvWorker" title="tianshou.env.worker.dummy.DummyEnvWorker"><span class="pre">DummyEnvWorker</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/dummy.html#DummyEnvWorker.wait"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.DummyEnvWorker.wait" title="Link to this definition">¶</a></dt>
<dd><p>Given a list of workers, return those ready ones.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.DummyEnvWorker.send">
<span class="sig-name descname"><span class="pre">send</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/dummy.html#DummyEnvWorker.send"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.DummyEnvWorker.send" title="Link to this definition">¶</a></dt>
<dd><p>Send action signal to low-level worker.</p>
<p>When action is None, it indicates sending “reset” signal; otherwise
it indicates “step” signal. The paired return value from “recv”
function is determined by such kind of different signal.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.DummyEnvWorker.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/dummy.html#DummyEnvWorker.seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.DummyEnvWorker.seed" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.DummyEnvWorker.render">
<span class="sig-name descname"><span class="pre">render</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/dummy.html#DummyEnvWorker.render"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.DummyEnvWorker.render" title="Link to this definition">¶</a></dt>
<dd><p>Render the environment.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.DummyEnvWorker.close_env">
<span class="sig-name descname"><span class="pre">close_env</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/dummy.html#DummyEnvWorker.close_env"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.DummyEnvWorker.close_env" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="subprocenvworker">
<h3>SubprocEnvWorker<a class="headerlink" href="#subprocenvworker" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tianshou.env.worker.SubprocEnvWorker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.env.worker.</span></span><span class="sig-name descname"><span class="pre">SubprocEnvWorker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Env</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">share_memory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/env/worker/subproc.html#SubprocEnvWorker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.SubprocEnvWorker" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tianshou.env.worker.EnvWorker" title="tianshou.env.worker.base.EnvWorker"><code class="xref py py-class docutils literal notranslate"><span class="pre">EnvWorker</span></code></a></p>
<p>Subprocess worker used in SubprocVectorEnv and ShmemVectorEnv.</p>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.SubprocEnvWorker.get_env_attr">
<span class="sig-name descname"><span class="pre">get_env_attr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/subproc.html#SubprocEnvWorker.get_env_attr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.SubprocEnvWorker.get_env_attr" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.SubprocEnvWorker.set_env_attr">
<span class="sig-name descname"><span class="pre">set_env_attr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/subproc.html#SubprocEnvWorker.set_env_attr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.SubprocEnvWorker.set_env_attr" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.SubprocEnvWorker.wait">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">wait</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#tianshou.env.worker.SubprocEnvWorker" title="tianshou.env.worker.subproc.SubprocEnvWorker"><span class="pre">SubprocEnvWorker</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wait_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#tianshou.env.worker.SubprocEnvWorker" title="tianshou.env.worker.subproc.SubprocEnvWorker"><span class="pre">SubprocEnvWorker</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/subproc.html#SubprocEnvWorker.wait"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.SubprocEnvWorker.wait" title="Link to this definition">¶</a></dt>
<dd><p>Given a list of workers, return those ready ones.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.SubprocEnvWorker.send">
<span class="sig-name descname"><span class="pre">send</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/subproc.html#SubprocEnvWorker.send"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.SubprocEnvWorker.send" title="Link to this definition">¶</a></dt>
<dd><p>Send action signal to low-level worker.</p>
<p>When action is None, it indicates sending “reset” signal; otherwise
it indicates “step” signal. The paired return value from “recv”
function is determined by such kind of different signal.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.SubprocEnvWorker.recv">
<span class="sig-name descname"><span class="pre">recv</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/subproc.html#SubprocEnvWorker.recv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.SubprocEnvWorker.recv" title="Link to this definition">¶</a></dt>
<dd><p>Receive result from low-level worker.</p>
<p>If the last “send” function sends a NULL action, it only returns a
single observation; otherwise it returns a tuple of (obs, rew, done,
info) or (obs, rew, terminated, truncated, info), based on whether
the environment is using the old step API or the new one.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.SubprocEnvWorker.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/subproc.html#SubprocEnvWorker.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.SubprocEnvWorker.reset" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.SubprocEnvWorker.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/subproc.html#SubprocEnvWorker.seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.SubprocEnvWorker.seed" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.SubprocEnvWorker.render">
<span class="sig-name descname"><span class="pre">render</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/subproc.html#SubprocEnvWorker.render"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.SubprocEnvWorker.render" title="Link to this definition">¶</a></dt>
<dd><p>Render the environment.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.SubprocEnvWorker.close_env">
<span class="sig-name descname"><span class="pre">close_env</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/subproc.html#SubprocEnvWorker.close_env"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.SubprocEnvWorker.close_env" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="rayenvworker">
<h3>RayEnvWorker<a class="headerlink" href="#rayenvworker" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tianshou.env.worker.RayEnvWorker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.env.worker.</span></span><span class="sig-name descname"><span class="pre">RayEnvWorker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Env</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/env/worker/ray.html#RayEnvWorker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.RayEnvWorker" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tianshou.env.worker.EnvWorker" title="tianshou.env.worker.base.EnvWorker"><code class="xref py py-class docutils literal notranslate"><span class="pre">EnvWorker</span></code></a></p>
<p>Ray worker used in RayVectorEnv.</p>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.RayEnvWorker.get_env_attr">
<span class="sig-name descname"><span class="pre">get_env_attr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/ray.html#RayEnvWorker.get_env_attr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.RayEnvWorker.get_env_attr" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.RayEnvWorker.set_env_attr">
<span class="sig-name descname"><span class="pre">set_env_attr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/ray.html#RayEnvWorker.set_env_attr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.RayEnvWorker.set_env_attr" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.RayEnvWorker.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/ray.html#RayEnvWorker.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.RayEnvWorker.reset" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.RayEnvWorker.wait">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">wait</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#tianshou.env.worker.RayEnvWorker" title="tianshou.env.worker.ray.RayEnvWorker"><span class="pre">RayEnvWorker</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wait_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#tianshou.env.worker.RayEnvWorker" title="tianshou.env.worker.ray.RayEnvWorker"><span class="pre">RayEnvWorker</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/ray.html#RayEnvWorker.wait"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.RayEnvWorker.wait" title="Link to this definition">¶</a></dt>
<dd><p>Given a list of workers, return those ready ones.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.RayEnvWorker.send">
<span class="sig-name descname"><span class="pre">send</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/ray.html#RayEnvWorker.send"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.RayEnvWorker.send" title="Link to this definition">¶</a></dt>
<dd><p>Send action signal to low-level worker.</p>
<p>When action is None, it indicates sending “reset” signal; otherwise
it indicates “step” signal. The paired return value from “recv”
function is determined by such kind of different signal.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.RayEnvWorker.recv">
<span class="sig-name descname"><span class="pre">recv</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/ray.html#RayEnvWorker.recv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.RayEnvWorker.recv" title="Link to this definition">¶</a></dt>
<dd><p>Receive result from low-level worker.</p>
<p>If the last “send” function sends a NULL action, it only returns a
single observation; otherwise it returns a tuple of (obs, rew, done,
info) or (obs, rew, terminated, truncated, info), based on whether
the environment is using the old step API or the new one.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.RayEnvWorker.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/ray.html#RayEnvWorker.seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.RayEnvWorker.seed" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.RayEnvWorker.render">
<span class="sig-name descname"><span class="pre">render</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/ray.html#RayEnvWorker.render"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.RayEnvWorker.render" title="Link to this definition">¶</a></dt>
<dd><p>Render the environment.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.worker.RayEnvWorker.close_env">
<span class="sig-name descname"><span class="pre">close_env</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/env/worker/ray.html#RayEnvWorker.close_env"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.worker.RayEnvWorker.close_env" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
</section>
<section id="utils">
<h2>Utils<a class="headerlink" href="#utils" title="Link to this heading">¶</a></h2>
<section id="pettingzooenv">
<h3>PettingZooEnv<a class="headerlink" href="#pettingzooenv" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tianshou.env.PettingZooEnv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.env.</span></span><span class="sig-name descname"><span class="pre">PettingZooEnv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BaseWrapper</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/env/pettingzoo_env.html#PettingZooEnv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.PettingZooEnv" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">AECEnv</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>The interface for petting zoo environments.</p>
<p>Multi-agent environments must be wrapped as
<a class="reference internal" href="#tianshou.env.PettingZooEnv" title="tianshou.env.PettingZooEnv"><code class="xref py py-class docutils literal notranslate"><span class="pre">PettingZooEnv</span></code></a>. Here is the usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">env</span> <span class="o">=</span> <span class="n">PettingZooEnv</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="c1"># obs is a dict containing obs, agent_id, and mask</span>
<span class="n">obs</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="n">action</span> <span class="o">=</span> <span class="n">policy</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="n">obs</span><span class="p">,</span> <span class="n">rew</span><span class="p">,</span> <span class="n">trunc</span><span class="p">,</span> <span class="n">term</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
<span class="n">env</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>The available action’s mask is set to True, otherwise it is set to False.
Further usage can be found at <a class="reference internal" href="../tutorials/cheatsheet.html#marl-example"><span class="std std-ref">Multi-Agent Reinforcement Learning</span></a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.PettingZooEnv.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/env/pettingzoo_env.html#PettingZooEnv.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.PettingZooEnv.reset" title="Link to this definition">¶</a></dt>
<dd><p>Resets the environment to a starting state.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.PettingZooEnv.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/env/pettingzoo_env.html#PettingZooEnv.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.PettingZooEnv.step" title="Link to this definition">¶</a></dt>
<dd><p>Accepts and executes the action of the current agent_selection in the environment.</p>
<p>Automatically switches control to the next agent.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.PettingZooEnv.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/env/pettingzoo_env.html#PettingZooEnv.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.PettingZooEnv.close" title="Link to this definition">¶</a></dt>
<dd><p>Closes any resources that should be released.</p>
<p>Closes the rendering window, subprocesses, network connections,
or any other resources that should be released.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.PettingZooEnv.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/env/pettingzoo_env.html#PettingZooEnv.seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.PettingZooEnv.seed" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.env.PettingZooEnv.render">
<span class="sig-name descname"><span class="pre">render</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/tianshou/env/pettingzoo_env.html#PettingZooEnv.render"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.env.PettingZooEnv.render" title="Link to this definition">¶</a></dt>
<dd><p>Renders the environment as specified by self.render_mode.</p>
<p>Render mode can be <cite>human</cite> to display a window.
Other render modes in the default environments are <cite>‘rgb_array’</cite>
which returns a numpy array and is supported by all environments outside of classic,
and <cite>‘ansi’</cite> which returns the strings printed (specific to classic environments).</p>
</dd></dl>

</dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tianshou.data.html" class="btn btn-neutral float-left" title="tianshou.data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tianshou.policy.html" class="btn btn-neutral float-right" title="tianshou.policy" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Tianshou contributors..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>