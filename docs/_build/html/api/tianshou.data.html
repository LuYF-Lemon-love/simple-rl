<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>tianshou.data &mdash; Tianshou 0.5.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/style.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/documentation_options.js?v=b9afe91b"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="https://cdn.jsdelivr.net/npm/vega@5.20.2"></script>
        <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.1.0"></script>
        <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.17.0"></script>
        <script src="../_static/js/copybutton.js?v=7db002fe"></script>
        <script src="../_static/js/benchmark.js?v=1091b9f3"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="tianshou.env" href="tianshou.env.html" />
    <link rel="prev" title="Cheat Sheet" href="../tutorials/cheatsheet.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Tianshou
              <img src="../_static/tianshou-logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.5.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/get_started.html">Get Started with Jupyter Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/dqn.html">Deep Q Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/concepts.html">Basic concepts in Tianshou</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/batch.html">Understand Batch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/tictactoe.html">Multi-Agent RL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/logger.html">Logging Experiments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/benchmark.html">Benchmark</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/cheatsheet.html">Cheat Sheet</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Docs</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">tianshou.data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#batch">Batch</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tianshou.data.Batch"><code class="docutils literal notranslate"><span class="pre">Batch</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.data.Batch.__getitem__"><code class="docutils literal notranslate"><span class="pre">Batch.__getitem__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.data.Batch.__setitem__"><code class="docutils literal notranslate"><span class="pre">Batch.__setitem__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.data.Batch.to_numpy"><code class="docutils literal notranslate"><span class="pre">Batch.to_numpy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.data.Batch.to_torch"><code class="docutils literal notranslate"><span class="pre">Batch.to_torch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.data.Batch.cat_"><code class="docutils literal notranslate"><span class="pre">Batch.cat_()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.data.Batch.cat"><code class="docutils literal notranslate"><span class="pre">Batch.cat()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.data.Batch.stack_"><code class="docutils literal notranslate"><span class="pre">Batch.stack_()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.data.Batch.stack"><code class="docutils literal notranslate"><span class="pre">Batch.stack()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.data.Batch.empty_"><code class="docutils literal notranslate"><span class="pre">Batch.empty_()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.data.Batch.empty"><code class="docutils literal notranslate"><span class="pre">Batch.empty()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.data.Batch.update"><code class="docutils literal notranslate"><span class="pre">Batch.update()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.data.Batch.__len__"><code class="docutils literal notranslate"><span class="pre">Batch.__len__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.data.Batch.is_empty"><code class="docutils literal notranslate"><span class="pre">Batch.is_empty()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.data.Batch.shape"><code class="docutils literal notranslate"><span class="pre">Batch.shape</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.data.Batch.split"><code class="docutils literal notranslate"><span class="pre">Batch.split()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#buffer">Buffer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#replaybuffer">ReplayBuffer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.data.ReplayBuffer"><code class="docutils literal notranslate"><span class="pre">ReplayBuffer</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#prioritizedreplaybuffer">PrioritizedReplayBuffer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.data.PrioritizedReplayBuffer"><code class="docutils literal notranslate"><span class="pre">PrioritizedReplayBuffer</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#herreplaybuffer">HERReplayBuffer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.data.HERReplayBuffer"><code class="docutils literal notranslate"><span class="pre">HERReplayBuffer</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#replaybuffermanager">ReplayBufferManager</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.data.ReplayBufferManager"><code class="docutils literal notranslate"><span class="pre">ReplayBufferManager</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#prioritizedreplaybuffermanager">PrioritizedReplayBufferManager</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.data.PrioritizedReplayBufferManager"><code class="docutils literal notranslate"><span class="pre">PrioritizedReplayBufferManager</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#herreplaybuffermanager">HERReplayBufferManager</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.data.HERReplayBufferManager"><code class="docutils literal notranslate"><span class="pre">HERReplayBufferManager</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vectorreplaybuffer">VectorReplayBuffer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.data.VectorReplayBuffer"><code class="docutils literal notranslate"><span class="pre">VectorReplayBuffer</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#prioritizedvectorreplaybuffer">PrioritizedVectorReplayBuffer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.data.PrioritizedVectorReplayBuffer"><code class="docutils literal notranslate"><span class="pre">PrioritizedVectorReplayBuffer</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hervectorreplaybuffer">HERVectorReplayBuffer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.data.HERVectorReplayBuffer"><code class="docutils literal notranslate"><span class="pre">HERVectorReplayBuffer</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#cachedreplaybuffer">CachedReplayBuffer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.data.CachedReplayBuffer"><code class="docutils literal notranslate"><span class="pre">CachedReplayBuffer</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#collector">Collector</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">Collector</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.data.Collector"><code class="docutils literal notranslate"><span class="pre">Collector</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#asynccollector">AsyncCollector</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.data.AsyncCollector"><code class="docutils literal notranslate"><span class="pre">AsyncCollector</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#utils">Utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#to-numpy">to_numpy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.data.to_numpy"><code class="docutils literal notranslate"><span class="pre">to_numpy()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#to-torch">to_torch</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.data.to_torch"><code class="docutils literal notranslate"><span class="pre">to_torch()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#to-torch-as">to_torch_as</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.data.to_torch_as"><code class="docutils literal notranslate"><span class="pre">to_torch_as()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#segmenttree">SegmentTree</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianshou.data.SegmentTree"><code class="docutils literal notranslate"><span class="pre">SegmentTree</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tianshou.env.html">tianshou.env</a></li>
<li class="toctree-l1"><a class="reference internal" href="tianshou.policy.html">tianshou.policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="tianshou.trainer.html">tianshou.trainer</a></li>
<li class="toctree-l1"><a class="reference internal" href="tianshou.exploration.html">tianshou.exploration</a></li>
<li class="toctree-l1"><a class="reference internal" href="tianshou.utils.html">tianshou.utils</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing to Tianshou</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributor.html">Contributor</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Tianshou</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">tianshou.data</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/tianshou.data.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tianshou-data">
<h1>tianshou.data<a class="headerlink" href="#tianshou-data" title="Link to this heading">¶</a></h1>
<section id="batch">
<h2>Batch<a class="headerlink" href="#batch" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="tianshou.data.Batch">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.data.</span></span><span class="sig-name descname"><span class="pre">Batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">BatchProtocol</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">BatchProtocol</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/data/batch.html#Batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.Batch" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BatchProtocol</span></code></p>
<p>The internal data structure in Tianshou.</p>
<p>Batch is a kind of supercharged array (of temporal data) stored individually in a
(recursive) dictionary of objects that can be either numpy arrays, torch tensors, or
batches themselves. It is designed to make it extremely easily to access, manipulate
and set partial view of the heterogeneous data conveniently.</p>
<p>For a detailed description, please refer to <a class="reference internal" href="../tutorials/batch.html#batch-concept"><span class="std std-ref">Understand Batch</span></a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.Batch.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/tianshou/data/batch.html#Batch.__getitem__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.Batch.__getitem__" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">slice</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TBatch</span></span></span></dt>
<dd><p>Return self[index].</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.Batch.__setitem__">
<span class="sig-name descname"><span class="pre">__setitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">slice</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/data/batch.html#Batch.__setitem__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.Batch.__setitem__" title="Link to this definition">¶</a></dt>
<dd><p>Assign value to self[index].</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.Batch.to_numpy">
<span class="sig-name descname"><span class="pre">to_numpy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/data/batch.html#Batch.to_numpy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.Batch.to_numpy" title="Link to this definition">¶</a></dt>
<dd><p>Change all torch.Tensor to numpy.ndarray in-place.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.Batch.to_torch">
<span class="sig-name descname"><span class="pre">to_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/data/batch.html#Batch.to_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.Batch.to_torch" title="Link to this definition">¶</a></dt>
<dd><p>Change all numpy.ndarray to torch.Tensor in-place.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.Batch.cat_">
<span class="sig-name descname"><span class="pre">cat_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batches</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BatchProtocol</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">BatchProtocol</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/data/batch.html#Batch.cat_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.Batch.cat_" title="Link to this definition">¶</a></dt>
<dd><p>Concatenate a list of (or one) Batch objects into current batch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.Batch.cat">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batches</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TBatch</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TBatch</span></span></span><a class="reference internal" href="../_modules/tianshou/data/batch.html#Batch.cat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.Batch.cat" title="Link to this definition">¶</a></dt>
<dd><p>Concatenate a list of Batch object into a single new batch.</p>
<p>For keys that are not shared across all batches, batches that do not
have these keys will be padded by zeros with appropriate shapes. E.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">Batch</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span> <span class="n">common</span><span class="o">=</span><span class="n">Batch</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">])))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">Batch</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="n">common</span><span class="o">=</span><span class="n">Batch</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Batch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(7, 4)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(7, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">common</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(7, 5)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.Batch.stack_">
<span class="sig-name descname"><span class="pre">stack_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batches</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">BatchProtocol</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/data/batch.html#Batch.stack_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.Batch.stack_" title="Link to this definition">¶</a></dt>
<dd><p>Stack a list of Batch object into current batch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.Batch.stack">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batches</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TBatch</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TBatch</span></span></span><a class="reference internal" href="../_modules/tianshou/data/batch.html#Batch.stack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.Batch.stack" title="Link to this definition">¶</a></dt>
<dd><p>Stack a list of Batch object into a single new batch.</p>
<p>For keys that are not shared across all batches, batches that do not
have these keys will be padded by zeros. E.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">Batch</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span> <span class="n">common</span><span class="o">=</span><span class="n">Batch</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">Batch</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]),</span> <span class="n">common</span><span class="o">=</span><span class="n">Batch</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Batch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 4, 4)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 4, 6)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">common</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 4, 5)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If there are keys that are not shared across all batches, <code class="docutils literal notranslate"><span class="pre">stack</span></code>
with <code class="docutils literal notranslate"><span class="pre">axis</span> <span class="pre">!=</span> <span class="pre">0</span></code> is undefined, and will cause an exception.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.Batch.empty_">
<span class="sig-name descname"><span class="pre">empty_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">slice</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TBatch</span></span></span><a class="reference internal" href="../_modules/tianshou/data/batch.html#Batch.empty_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.Batch.empty_" title="Link to this definition">¶</a></dt>
<dd><p>Return an empty Batch object with 0 or None filled.</p>
<p>If “index” is specified, it will only reset the specific indexed-data.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">empty_</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="go">Batch(</span>
<span class="go">    a: array([[0., 0.],</span>
<span class="go">              [0., 0.]]),</span>
<span class="go">    b: array([None, None], dtype=object),</span>
<span class="go">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.</span><span class="p">,</span> <span class="s1">&#39;st&#39;</span><span class="p">],</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">Batch</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span>  <span class="kc">True</span><span class="p">],</span> <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Batch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span>
<span class="go">Batch(</span>
<span class="go">    a: array([False,  True]),</span>
<span class="go">    b: Batch(</span>
<span class="go">           c: array([None, &#39;st&#39;]),</span>
<span class="go">           d: array([0., 0.]),</span>
<span class="go">       ),</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.Batch.empty">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">empty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TBatch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">slice</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TBatch</span></span></span><a class="reference internal" href="../_modules/tianshou/data/batch.html#Batch.empty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.Batch.empty" title="Link to this definition">¶</a></dt>
<dd><p>Return an empty Batch object with 0 or None filled.</p>
<p>The shape is the same as the given Batch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.Batch.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TBatch</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/data/batch.html#Batch.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.Batch.update" title="Link to this definition">¶</a></dt>
<dd><p>Update this batch from another dict/Batch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.Batch.__len__">
<span class="sig-name descname"><span class="pre">__len__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="../_modules/tianshou/data/batch.html#Batch.__len__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.Batch.__len__" title="Link to this definition">¶</a></dt>
<dd><p>Return len(self).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.Batch.is_empty">
<span class="sig-name descname"><span class="pre">is_empty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">recurse</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/tianshou/data/batch.html#Batch.is_empty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.Batch.is_empty" title="Link to this definition">¶</a></dt>
<dd><p>Test if a Batch is empty.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">recurse=True</span></code>, it further tests the values of the object; else
it only tests the existence of any key.</p>
<p><code class="docutils literal notranslate"><span class="pre">b.is_empty(recurse=True)</span></code> is mainly used to distinguish
<code class="docutils literal notranslate"><span class="pre">Batch(a=Batch(a=Batch()))</span></code> and <code class="docutils literal notranslate"><span class="pre">Batch(a=1)</span></code>. They both raise
exceptions when applied to <code class="docutils literal notranslate"><span class="pre">len()</span></code>, but the former can be used in
<code class="docutils literal notranslate"><span class="pre">cat</span></code>, while the latter is a scalar and cannot be used in <code class="docutils literal notranslate"><span class="pre">cat</span></code>.</p>
<p>Another usage is in <code class="docutils literal notranslate"><span class="pre">__len__</span></code>, where we have to skip checking the
length of recursively empty Batch.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Batch</span><span class="p">()</span><span class="o">.</span><span class="n">is_empty</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Batch</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">Batch</span><span class="p">(),</span> <span class="n">b</span><span class="o">=</span><span class="n">Batch</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="n">Batch</span><span class="p">()))</span><span class="o">.</span><span class="n">is_empty</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Batch</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">Batch</span><span class="p">(),</span> <span class="n">b</span><span class="o">=</span><span class="n">Batch</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="n">Batch</span><span class="p">()))</span><span class="o">.</span><span class="n">is_empty</span><span class="p">(</span><span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Batch</span><span class="p">(</span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_empty</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Batch</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">1.0</span><span class="p">))</span><span class="o">.</span><span class="n">is_empty</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tianshou.data.Batch.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tianshou.data.Batch.shape" title="Link to this definition">¶</a></dt>
<dd><p>Return self.shape.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.Batch.split">
<span class="sig-name descname"><span class="pre">split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">merge_last</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">TBatch</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/data/batch.html#Batch.split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.Batch.split" title="Link to this definition">¶</a></dt>
<dd><p>Split whole data into multiple small batches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<em>int</em>) – divide the data batch with the given size, but one
batch if the length of the batch is smaller than “size”. Size of -1 means
the whole batch.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em>) – randomly shuffle the entire data batch if it is
True, otherwise remain in the same. Default to True.</p></li>
<li><p><strong>merge_last</strong> (<em>bool</em>) – merge the last batch into the previous one.
Default to False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="buffer">
<h2>Buffer<a class="headerlink" href="#buffer" title="Link to this heading">¶</a></h2>
<section id="replaybuffer">
<h3>ReplayBuffer<a class="headerlink" href="#replaybuffer" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tianshou.data.ReplayBuffer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.data.</span></span><span class="sig-name descname"><span class="pre">ReplayBuffer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stack_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_obs_next</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_only_last_obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_avail</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/data/buffer/base.html#ReplayBuffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.ReplayBuffer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p><a class="reference internal" href="#tianshou.data.ReplayBuffer" title="tianshou.data.ReplayBuffer"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReplayBuffer</span></code></a> stores data generated from interaction     between the policy and environment.</p>
<p>ReplayBuffer can be considered as a specialized form (or management) of Batch. It
stores all the data in a batch with circular-queue style.</p>
<p>For the example usage of ReplayBuffer, please check out Section Buffer in
<a class="reference internal" href="../tutorials/concepts.html"><span class="doc">Basic concepts in Tianshou</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<em>int</em>) – the maximum size of replay buffer.</p></li>
<li><p><strong>stack_num</strong> (<em>int</em>) – the frame-stack sampling argument, should be greater than or
equal to 1. Default to 1 (no stacking).</p></li>
<li><p><strong>ignore_obs_next</strong> (<em>bool</em>) – whether to store obs_next. Default to False.</p></li>
<li><p><strong>save_only_last_obs</strong> (<em>bool</em>) – only save the last obs/obs_next when it has a shape
of (timestep, …) because of temporal stacking. Default to False.</p></li>
<li><p><strong>sample_avail</strong> (<em>bool</em>) – the parameter indicating sampling only available index
when using frame-stack sampling method. Default to False.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.ReplayBuffer.__len__">
<span class="sig-name descname"><span class="pre">__len__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/base.html#ReplayBuffer.__len__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.ReplayBuffer.__len__" title="Link to this definition">¶</a></dt>
<dd><p>Return len(self).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.ReplayBuffer.save_hdf5">
<span class="sig-name descname"><span class="pre">save_hdf5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compression</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/base.html#ReplayBuffer.save_hdf5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.ReplayBuffer.save_hdf5" title="Link to this definition">¶</a></dt>
<dd><p>Save replay buffer to HDF5 file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.ReplayBuffer.load_hdf5">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_hdf5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tianshou.data.ReplayBuffer" title="tianshou.data.buffer.base.ReplayBuffer"><span class="pre">ReplayBuffer</span></a></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/base.html#ReplayBuffer.load_hdf5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.ReplayBuffer.load_hdf5" title="Link to this definition">¶</a></dt>
<dd><p>Load replay buffer from HDF5 file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.ReplayBuffer.from_data">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rew</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terminated</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncated</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">done</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_next</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tianshou.data.ReplayBuffer" title="tianshou.data.buffer.base.ReplayBuffer"><span class="pre">ReplayBuffer</span></a></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/base.html#ReplayBuffer.from_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.ReplayBuffer.from_data" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.ReplayBuffer.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keep_statistics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/base.html#ReplayBuffer.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.ReplayBuffer.reset" title="Link to this definition">¶</a></dt>
<dd><p>Clear all the data in replay buffer and episode statistics.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.ReplayBuffer.set_batch">
<span class="sig-name descname"><span class="pre">set_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">RolloutBatchProtocol</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/base.html#ReplayBuffer.set_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.ReplayBuffer.set_batch" title="Link to this definition">¶</a></dt>
<dd><p>Manually choose the batch you want the ReplayBuffer to manage.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.ReplayBuffer.unfinished_index">
<span class="sig-name descname"><span class="pre">unfinished_index</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/base.html#ReplayBuffer.unfinished_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.ReplayBuffer.unfinished_index" title="Link to this definition">¶</a></dt>
<dd><p>Return the index of unfinished episode.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.ReplayBuffer.prev">
<span class="sig-name descname"><span class="pre">prev</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/base.html#ReplayBuffer.prev"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.ReplayBuffer.prev" title="Link to this definition">¶</a></dt>
<dd><p>Return the index of previous transition.</p>
<p>The index won’t be modified if it is the beginning of an episode.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.ReplayBuffer.next">
<span class="sig-name descname"><span class="pre">next</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/base.html#ReplayBuffer.next"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.ReplayBuffer.next" title="Link to this definition">¶</a></dt>
<dd><p>Return the index of next transition.</p>
<p>The index won’t be modified if it is the end of an episode.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.ReplayBuffer.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buffer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#tianshou.data.ReplayBuffer" title="tianshou.data.buffer.base.ReplayBuffer"><span class="pre">ReplayBuffer</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/base.html#ReplayBuffer.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.ReplayBuffer.update" title="Link to this definition">¶</a></dt>
<dd><p>Move the data from the given buffer to current buffer.</p>
<p>Return the updated indices. If update fails, return an empty array.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.ReplayBuffer.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">RolloutBatchProtocol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/base.html#ReplayBuffer.add"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.ReplayBuffer.add" title="Link to this definition">¶</a></dt>
<dd><p>Add a batch of data into replay buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<a class="reference internal" href="#tianshou.data.Batch" title="tianshou.data.Batch"><em>Batch</em></a>) – the input data batch. “obs”, “act”, “rew”,
“terminated”, “truncated” are required keys.</p></li>
<li><p><strong>buffer_ids</strong> – to make consistent with other buffer’s add function; if it
is not None, we assume the input batch’s first dimension is always 1.</p></li>
</ul>
</dd>
</dl>
<p>Return (current_index, episode_reward, episode_length, episode_start_index). If
the episode is not finished, the return value of episode_length and
episode_reward is 0.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.ReplayBuffer.sample_indices">
<span class="sig-name descname"><span class="pre">sample_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/base.html#ReplayBuffer.sample_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.ReplayBuffer.sample_indices" title="Link to this definition">¶</a></dt>
<dd><p>Get a random sample of index with size = batch_size.</p>
<p>Return all available indices in the buffer if batch_size is 0; return an empty
numpy array if batch_size &lt; 0 or no available index can be sampled.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.ReplayBuffer.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">RolloutBatchProtocol</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/base.html#ReplayBuffer.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.ReplayBuffer.sample" title="Link to this definition">¶</a></dt>
<dd><p>Get a random sample from buffer with size = batch_size.</p>
<p>Return all the data in the buffer if batch_size is 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Sample data and its corresponding index inside the buffer.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.ReplayBuffer.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stack_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tianshou.data.Batch" title="tianshou.data.batch.Batch"><span class="pre">Batch</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/base.html#ReplayBuffer.get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.ReplayBuffer.get" title="Link to this definition">¶</a></dt>
<dd><p>Return the stacked result.</p>
<p>E.g., if you set <code class="docutils literal notranslate"><span class="pre">key</span> <span class="pre">=</span> <span class="pre">&quot;obs&quot;,</span> <span class="pre">stack_num</span> <span class="pre">=</span> <span class="pre">4,</span> <span class="pre">index</span> <span class="pre">=</span> <span class="pre">t</span></code>, it returns the
stacked result as <code class="docutils literal notranslate"><span class="pre">[obs[t-3],</span> <span class="pre">obs[t-2],</span> <span class="pre">obs[t-1],</span> <span class="pre">obs[t]]</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> – the index for getting stacked data.</p></li>
<li><p><strong>key</strong> (<em>str</em>) – the key to get, should be one of the reserved_keys.</p></li>
<li><p><strong>default_value</strong> – if the given key’s data is not found and default_value is
set, return this default_value.</p></li>
<li><p><strong>stack_num</strong> (<em>int</em>) – Default to self.stack_num.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.ReplayBuffer.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">slice</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">RolloutBatchProtocol</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/base.html#ReplayBuffer.__getitem__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.ReplayBuffer.__getitem__" title="Link to this definition">¶</a></dt>
<dd><p>Return a data batch: self[index].</p>
<p>If stack_num is larger than 1, return the stacked obs and obs_next with shape
(batch, len, …).</p>
</dd></dl>

</dd></dl>

</section>
<section id="prioritizedreplaybuffer">
<h3>PrioritizedReplayBuffer<a class="headerlink" href="#prioritizedreplaybuffer" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tianshou.data.PrioritizedReplayBuffer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.data.</span></span><span class="sig-name descname"><span class="pre">PrioritizedReplayBuffer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_norm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/data/buffer/prio.html#PrioritizedReplayBuffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.PrioritizedReplayBuffer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tianshou.data.ReplayBuffer" title="tianshou.data.buffer.base.ReplayBuffer"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReplayBuffer</span></code></a></p>
<p>Implementation of Prioritized Experience Replay. arXiv:1511.05952.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alpha</strong> (<em>float</em>) – the prioritization exponent.</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – the importance sample soft coefficient.</p></li>
<li><p><strong>weight_norm</strong> (<em>bool</em>) – whether to normalize returned weights with the maximum
weight value within the batch. Default to True.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Please refer to <a class="reference internal" href="#tianshou.data.ReplayBuffer" title="tianshou.data.ReplayBuffer"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReplayBuffer</span></code></a> for other APIs’ usage.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.PrioritizedReplayBuffer.init_weight">
<span class="sig-name descname"><span class="pre">init_weight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/prio.html#PrioritizedReplayBuffer.init_weight"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.PrioritizedReplayBuffer.init_weight" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.PrioritizedReplayBuffer.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buffer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#tianshou.data.ReplayBuffer" title="tianshou.data.buffer.base.ReplayBuffer"><span class="pre">ReplayBuffer</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/prio.html#PrioritizedReplayBuffer.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.PrioritizedReplayBuffer.update" title="Link to this definition">¶</a></dt>
<dd><p>Move the data from the given buffer to current buffer.</p>
<p>Return the updated indices. If update fails, return an empty array.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.PrioritizedReplayBuffer.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">RolloutBatchProtocol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/prio.html#PrioritizedReplayBuffer.add"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.PrioritizedReplayBuffer.add" title="Link to this definition">¶</a></dt>
<dd><p>Add a batch of data into replay buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<a class="reference internal" href="#tianshou.data.Batch" title="tianshou.data.Batch"><em>Batch</em></a>) – the input data batch. “obs”, “act”, “rew”,
“terminated”, “truncated” are required keys.</p></li>
<li><p><strong>buffer_ids</strong> – to make consistent with other buffer’s add function; if it
is not None, we assume the input batch’s first dimension is always 1.</p></li>
</ul>
</dd>
</dl>
<p>Return (current_index, episode_reward, episode_length, episode_start_index). If
the episode is not finished, the return value of episode_length and
episode_reward is 0.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.PrioritizedReplayBuffer.sample_indices">
<span class="sig-name descname"><span class="pre">sample_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/prio.html#PrioritizedReplayBuffer.sample_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.PrioritizedReplayBuffer.sample_indices" title="Link to this definition">¶</a></dt>
<dd><p>Get a random sample of index with size = batch_size.</p>
<p>Return all available indices in the buffer if batch_size is 0; return an empty
numpy array if batch_size &lt; 0 or no available index can be sampled.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.PrioritizedReplayBuffer.get_weight">
<span class="sig-name descname"><span class="pre">get_weight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/prio.html#PrioritizedReplayBuffer.get_weight"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.PrioritizedReplayBuffer.get_weight" title="Link to this definition">¶</a></dt>
<dd><p>Get the importance sampling weight.</p>
<p>The “weight” in the returned Batch is the weight on loss function to debias
the sampling process (some transition tuples are sampled more often so their
losses are weighted less).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.PrioritizedReplayBuffer.update_weight">
<span class="sig-name descname"><span class="pre">update_weight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/prio.html#PrioritizedReplayBuffer.update_weight"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.PrioritizedReplayBuffer.update_weight" title="Link to this definition">¶</a></dt>
<dd><p>Update priority weight by index in this buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>np.ndarray</em>) – index you want to update weight.</p></li>
<li><p><strong>new_weight</strong> (<em>np.ndarray</em>) – new priority weight you want to update.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.PrioritizedReplayBuffer.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">slice</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">PrioBatchProtocol</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/prio.html#PrioritizedReplayBuffer.__getitem__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.PrioritizedReplayBuffer.__getitem__" title="Link to this definition">¶</a></dt>
<dd><p>Return a data batch: self[index].</p>
<p>If stack_num is larger than 1, return the stacked obs and obs_next with shape
(batch, len, …).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.PrioritizedReplayBuffer.set_beta">
<span class="sig-name descname"><span class="pre">set_beta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/prio.html#PrioritizedReplayBuffer.set_beta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.PrioritizedReplayBuffer.set_beta" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="herreplaybuffer">
<h3>HERReplayBuffer<a class="headerlink" href="#herreplaybuffer" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tianshou.data.HERReplayBuffer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.data.</span></span><span class="sig-name descname"><span class="pre">HERReplayBuffer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_reward_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">horizon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/data/buffer/her.html#HERReplayBuffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.HERReplayBuffer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tianshou.data.ReplayBuffer" title="tianshou.data.buffer.base.ReplayBuffer"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReplayBuffer</span></code></a></p>
<p>Implementation of Hindsight Experience Replay. arXiv:1707.01495.</p>
<p>HERReplayBuffer is to be used with goal-based environment where the
observation is a dictionary with keys <code class="docutils literal notranslate"><span class="pre">observation</span></code>, <code class="docutils literal notranslate"><span class="pre">achieved_goal</span></code> and
<code class="docutils literal notranslate"><span class="pre">desired_goal</span></code>. Currently support only HER’s future strategy, online sampling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<em>int</em>) – the size of the replay buffer.</p></li>
<li><p><strong>compute_reward_fn</strong> – a function that takes 2 <code class="docutils literal notranslate"><span class="pre">np.array</span></code> arguments,
<code class="docutils literal notranslate"><span class="pre">acheived_goal</span></code> and <code class="docutils literal notranslate"><span class="pre">desired_goal</span></code>, and returns rewards as <code class="docutils literal notranslate"><span class="pre">np.array</span></code>.
The two arguments are of shape (batch_size, …original_shape) and the returned
rewards must be of shape (batch_size,).</p></li>
<li><p><strong>horizon</strong> (<em>int</em>) – the maximum number of steps in an episode.</p></li>
<li><p><strong>future_k</strong> (<em>int</em>) – the ‘k’ parameter introduced in the paper. In short, there
will be at most k episodes that are re-written for every 1 unaltered episode
during the sampling.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Please refer to <a class="reference internal" href="#tianshou.data.ReplayBuffer" title="tianshou.data.ReplayBuffer"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReplayBuffer</span></code></a> for other APIs’ usage.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.HERReplayBuffer.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keep_statistics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/her.html#HERReplayBuffer.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.HERReplayBuffer.reset" title="Link to this definition">¶</a></dt>
<dd><p>Clear all the data in replay buffer and episode statistics.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.HERReplayBuffer.save_hdf5">
<span class="sig-name descname"><span class="pre">save_hdf5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compression</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/her.html#HERReplayBuffer.save_hdf5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.HERReplayBuffer.save_hdf5" title="Link to this definition">¶</a></dt>
<dd><p>Save replay buffer to HDF5 file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.HERReplayBuffer.set_batch">
<span class="sig-name descname"><span class="pre">set_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">RolloutBatchProtocol</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/her.html#HERReplayBuffer.set_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.HERReplayBuffer.set_batch" title="Link to this definition">¶</a></dt>
<dd><p>Manually choose the batch you want the ReplayBuffer to manage.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.HERReplayBuffer.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buffer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#tianshou.data.HERReplayBuffer" title="tianshou.data.buffer.her.HERReplayBuffer"><span class="pre">HERReplayBuffer</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#tianshou.data.ReplayBuffer" title="tianshou.data.buffer.base.ReplayBuffer"><span class="pre">ReplayBuffer</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/her.html#HERReplayBuffer.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.HERReplayBuffer.update" title="Link to this definition">¶</a></dt>
<dd><p>Move the data from the given buffer to current buffer.</p>
<p>Return the updated indices. If update fails, return an empty array.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.HERReplayBuffer.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">RolloutBatchProtocol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/her.html#HERReplayBuffer.add"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.HERReplayBuffer.add" title="Link to this definition">¶</a></dt>
<dd><p>Add a batch of data into replay buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<a class="reference internal" href="#tianshou.data.Batch" title="tianshou.data.Batch"><em>Batch</em></a>) – the input data batch. “obs”, “act”, “rew”,
“terminated”, “truncated” are required keys.</p></li>
<li><p><strong>buffer_ids</strong> – to make consistent with other buffer’s add function; if it
is not None, we assume the input batch’s first dimension is always 1.</p></li>
</ul>
</dd>
</dl>
<p>Return (current_index, episode_reward, episode_length, episode_start_index). If
the episode is not finished, the return value of episode_length and
episode_reward is 0.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.HERReplayBuffer.sample_indices">
<span class="sig-name descname"><span class="pre">sample_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/her.html#HERReplayBuffer.sample_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.HERReplayBuffer.sample_indices" title="Link to this definition">¶</a></dt>
<dd><p>Get a random sample of index with size = batch_size.</p>
<p>Return all available indices in the buffer if batch_size is 0; return an         empty numpy array if batch_size &lt; 0 or no available index can be sampled.         Additionally, some episodes of the sampled transitions will be re-written         according to HER.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.HERReplayBuffer.rewrite_transitions">
<span class="sig-name descname"><span class="pre">rewrite_transitions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/her.html#HERReplayBuffer.rewrite_transitions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.HERReplayBuffer.rewrite_transitions" title="Link to this definition">¶</a></dt>
<dd><p>Re-write the goal of some sampled transitions’ episodes according to HER.</p>
<p>Currently applies only HER’s ‘future’ strategy. The new goals will be written         directly to the internal batch data temporarily and will be restored right         before the next sampling or when using some of the buffer’s method (e.g.         <cite>add</cite>, <cite>save_hdf5</cite>, etc.). This is to make sure that n-step returns         calculation etc., performs correctly without additional alteration.</p>
</dd></dl>

</dd></dl>

</section>
<section id="replaybuffermanager">
<h3>ReplayBufferManager<a class="headerlink" href="#replaybuffermanager" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tianshou.data.ReplayBufferManager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.data.</span></span><span class="sig-name descname"><span class="pre">ReplayBufferManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buffer_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#tianshou.data.ReplayBuffer" title="tianshou.data.buffer.base.ReplayBuffer"><span class="pre">ReplayBuffer</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#tianshou.data.HERReplayBuffer" title="tianshou.data.buffer.her.HERReplayBuffer"><span class="pre">HERReplayBuffer</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/data/buffer/manager.html#ReplayBufferManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.ReplayBufferManager" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tianshou.data.ReplayBuffer" title="tianshou.data.buffer.base.ReplayBuffer"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReplayBuffer</span></code></a></p>
<p>ReplayBufferManager contains a list of ReplayBuffer with exactly the same     configuration.</p>
<p>These replay buffers have contiguous memory layout, and the storage space each
buffer has is a shallow copy of the topmost memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>buffer_list</strong> – a list of ReplayBuffer needed to be handled.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Please refer to <a class="reference internal" href="#tianshou.data.ReplayBuffer" title="tianshou.data.ReplayBuffer"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReplayBuffer</span></code></a> for other APIs’ usage.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.ReplayBufferManager.__len__">
<span class="sig-name descname"><span class="pre">__len__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/manager.html#ReplayBufferManager.__len__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.ReplayBufferManager.__len__" title="Link to this definition">¶</a></dt>
<dd><p>Return len(self).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.ReplayBufferManager.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keep_statistics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/manager.html#ReplayBufferManager.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.ReplayBufferManager.reset" title="Link to this definition">¶</a></dt>
<dd><p>Clear all the data in replay buffer and episode statistics.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.ReplayBufferManager.set_batch">
<span class="sig-name descname"><span class="pre">set_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">RolloutBatchProtocol</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/manager.html#ReplayBufferManager.set_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.ReplayBufferManager.set_batch" title="Link to this definition">¶</a></dt>
<dd><p>Manually choose the batch you want the ReplayBuffer to manage.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.ReplayBufferManager.unfinished_index">
<span class="sig-name descname"><span class="pre">unfinished_index</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/manager.html#ReplayBufferManager.unfinished_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.ReplayBufferManager.unfinished_index" title="Link to this definition">¶</a></dt>
<dd><p>Return the index of unfinished episode.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.ReplayBufferManager.prev">
<span class="sig-name descname"><span class="pre">prev</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/manager.html#ReplayBufferManager.prev"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.ReplayBufferManager.prev" title="Link to this definition">¶</a></dt>
<dd><p>Return the index of previous transition.</p>
<p>The index won’t be modified if it is the beginning of an episode.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.ReplayBufferManager.next">
<span class="sig-name descname"><span class="pre">next</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/manager.html#ReplayBufferManager.next"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.ReplayBufferManager.next" title="Link to this definition">¶</a></dt>
<dd><p>Return the index of next transition.</p>
<p>The index won’t be modified if it is the end of an episode.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.ReplayBufferManager.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buffer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#tianshou.data.ReplayBuffer" title="tianshou.data.buffer.base.ReplayBuffer"><span class="pre">ReplayBuffer</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/manager.html#ReplayBufferManager.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.ReplayBufferManager.update" title="Link to this definition">¶</a></dt>
<dd><p>The ReplayBufferManager cannot be updated by any buffer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.ReplayBufferManager.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">RolloutBatchProtocol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/manager.html#ReplayBufferManager.add"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.ReplayBufferManager.add" title="Link to this definition">¶</a></dt>
<dd><p>Add a batch of data into ReplayBufferManager.</p>
<p>Each of the data’s length (first dimension) must equal to the length of
buffer_ids. By default buffer_ids is [0, 1, …, buffer_num - 1].</p>
<p>Return (current_index, episode_reward, episode_length, episode_start_index). If
the episode is not finished, the return value of episode_length and
episode_reward is 0.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.ReplayBufferManager.sample_indices">
<span class="sig-name descname"><span class="pre">sample_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/manager.html#ReplayBufferManager.sample_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.ReplayBufferManager.sample_indices" title="Link to this definition">¶</a></dt>
<dd><p>Get a random sample of index with size = batch_size.</p>
<p>Return all available indices in the buffer if batch_size is 0; return an empty
numpy array if batch_size &lt; 0 or no available index can be sampled.</p>
</dd></dl>

</dd></dl>

</section>
<section id="prioritizedreplaybuffermanager">
<h3>PrioritizedReplayBufferManager<a class="headerlink" href="#prioritizedreplaybuffermanager" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tianshou.data.PrioritizedReplayBufferManager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.data.</span></span><span class="sig-name descname"><span class="pre">PrioritizedReplayBufferManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buffer_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#tianshou.data.PrioritizedReplayBuffer" title="tianshou.data.buffer.prio.PrioritizedReplayBuffer"><span class="pre">PrioritizedReplayBuffer</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/data/buffer/manager.html#PrioritizedReplayBufferManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.PrioritizedReplayBufferManager" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tianshou.data.PrioritizedReplayBuffer" title="tianshou.data.buffer.prio.PrioritizedReplayBuffer"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrioritizedReplayBuffer</span></code></a>, <a class="reference internal" href="#tianshou.data.ReplayBufferManager" title="tianshou.data.buffer.manager.ReplayBufferManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReplayBufferManager</span></code></a></p>
<p>PrioritizedReplayBufferManager contains a list of PrioritizedReplayBuffer with     exactly the same configuration.</p>
<p>These replay buffers have contiguous memory layout, and the storage space each
buffer has is a shallow copy of the topmost memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>buffer_list</strong> – a list of PrioritizedReplayBuffer needed to be handled.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Please refer to <a class="reference internal" href="#tianshou.data.ReplayBuffer" title="tianshou.data.ReplayBuffer"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReplayBuffer</span></code></a> for other APIs’ usage.</p>
</div>
</dd></dl>

</section>
<section id="herreplaybuffermanager">
<h3>HERReplayBufferManager<a class="headerlink" href="#herreplaybuffermanager" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tianshou.data.HERReplayBufferManager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.data.</span></span><span class="sig-name descname"><span class="pre">HERReplayBufferManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buffer_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#tianshou.data.HERReplayBuffer" title="tianshou.data.buffer.her.HERReplayBuffer"><span class="pre">HERReplayBuffer</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/data/buffer/manager.html#HERReplayBufferManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.HERReplayBufferManager" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tianshou.data.ReplayBufferManager" title="tianshou.data.buffer.manager.ReplayBufferManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReplayBufferManager</span></code></a></p>
<p>HERReplayBufferManager contains a list of HERReplayBuffer with     exactly the same configuration.</p>
<p>These replay buffers have contiguous memory layout, and the storage space each
buffer has is a shallow copy of the topmost memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>buffer_list</strong> – a list of HERReplayBuffer needed to be handled.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Please refer to <a class="reference internal" href="#tianshou.data.ReplayBuffer" title="tianshou.data.ReplayBuffer"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReplayBuffer</span></code></a> for other APIs’ usage.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.HERReplayBufferManager.save_hdf5">
<span class="sig-name descname"><span class="pre">save_hdf5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compression</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/manager.html#HERReplayBufferManager.save_hdf5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.HERReplayBufferManager.save_hdf5" title="Link to this definition">¶</a></dt>
<dd><p>Save replay buffer to HDF5 file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.HERReplayBufferManager.set_batch">
<span class="sig-name descname"><span class="pre">set_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">RolloutBatchProtocol</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/manager.html#HERReplayBufferManager.set_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.HERReplayBufferManager.set_batch" title="Link to this definition">¶</a></dt>
<dd><p>Manually choose the batch you want the ReplayBuffer to manage.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.HERReplayBufferManager.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buffer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#tianshou.data.HERReplayBuffer" title="tianshou.data.buffer.her.HERReplayBuffer"><span class="pre">HERReplayBuffer</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#tianshou.data.ReplayBuffer" title="tianshou.data.buffer.base.ReplayBuffer"><span class="pre">ReplayBuffer</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/manager.html#HERReplayBufferManager.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.HERReplayBufferManager.update" title="Link to this definition">¶</a></dt>
<dd><p>The ReplayBufferManager cannot be updated by any buffer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.HERReplayBufferManager.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">RolloutBatchProtocol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/manager.html#HERReplayBufferManager.add"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.HERReplayBufferManager.add" title="Link to this definition">¶</a></dt>
<dd><p>Add a batch of data into ReplayBufferManager.</p>
<p>Each of the data’s length (first dimension) must equal to the length of
buffer_ids. By default buffer_ids is [0, 1, …, buffer_num - 1].</p>
<p>Return (current_index, episode_reward, episode_length, episode_start_index). If
the episode is not finished, the return value of episode_length and
episode_reward is 0.</p>
</dd></dl>

</dd></dl>

</section>
<section id="vectorreplaybuffer">
<h3>VectorReplayBuffer<a class="headerlink" href="#vectorreplaybuffer" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tianshou.data.VectorReplayBuffer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.data.</span></span><span class="sig-name descname"><span class="pre">VectorReplayBuffer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">total_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/data/buffer/vecbuf.html#VectorReplayBuffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.VectorReplayBuffer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tianshou.data.ReplayBufferManager" title="tianshou.data.buffer.manager.ReplayBufferManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReplayBufferManager</span></code></a></p>
<p>VectorReplayBuffer contains n ReplayBuffer with the same size.</p>
<p>It is used for storing transition from different environments yet keeping the order
of time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>total_size</strong> (<em>int</em>) – the total size of VectorReplayBuffer.</p></li>
<li><p><strong>buffer_num</strong> (<em>int</em>) – the number of ReplayBuffer it uses, which are under the same
configuration.</p></li>
</ul>
</dd>
</dl>
<p>Other input arguments (stack_num/ignore_obs_next/save_only_last_obs/sample_avail)
are the same as <a class="reference internal" href="#tianshou.data.ReplayBuffer" title="tianshou.data.ReplayBuffer"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReplayBuffer</span></code></a>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Please refer to <a class="reference internal" href="#tianshou.data.ReplayBuffer" title="tianshou.data.ReplayBuffer"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReplayBuffer</span></code></a> for other APIs’ usage.</p>
</div>
</dd></dl>

</section>
<section id="prioritizedvectorreplaybuffer">
<h3>PrioritizedVectorReplayBuffer<a class="headerlink" href="#prioritizedvectorreplaybuffer" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tianshou.data.PrioritizedVectorReplayBuffer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.data.</span></span><span class="sig-name descname"><span class="pre">PrioritizedVectorReplayBuffer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">total_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/data/buffer/vecbuf.html#PrioritizedVectorReplayBuffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.PrioritizedVectorReplayBuffer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tianshou.data.PrioritizedReplayBufferManager" title="tianshou.data.buffer.manager.PrioritizedReplayBufferManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrioritizedReplayBufferManager</span></code></a></p>
<p>PrioritizedVectorReplayBuffer contains n PrioritizedReplayBuffer with same size.</p>
<p>It is used for storing transition from different environments yet keeping the order
of time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>total_size</strong> (<em>int</em>) – the total size of PrioritizedVectorReplayBuffer.</p></li>
<li><p><strong>buffer_num</strong> (<em>int</em>) – the number of PrioritizedReplayBuffer it uses, which are
under the same configuration.</p></li>
</ul>
</dd>
</dl>
<p>Other input arguments (alpha/beta/stack_num/ignore_obs_next/save_only_last_obs/
sample_avail) are the same as <a class="reference internal" href="#tianshou.data.PrioritizedReplayBuffer" title="tianshou.data.PrioritizedReplayBuffer"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrioritizedReplayBuffer</span></code></a>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Please refer to <a class="reference internal" href="#tianshou.data.ReplayBuffer" title="tianshou.data.ReplayBuffer"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReplayBuffer</span></code></a> for other APIs’ usage.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.PrioritizedVectorReplayBuffer.set_beta">
<span class="sig-name descname"><span class="pre">set_beta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/vecbuf.html#PrioritizedVectorReplayBuffer.set_beta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.PrioritizedVectorReplayBuffer.set_beta" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="hervectorreplaybuffer">
<h3>HERVectorReplayBuffer<a class="headerlink" href="#hervectorreplaybuffer" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tianshou.data.HERVectorReplayBuffer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.data.</span></span><span class="sig-name descname"><span class="pre">HERVectorReplayBuffer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">total_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/data/buffer/vecbuf.html#HERVectorReplayBuffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.HERVectorReplayBuffer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tianshou.data.HERReplayBufferManager" title="tianshou.data.buffer.manager.HERReplayBufferManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">HERReplayBufferManager</span></code></a></p>
<p>HERVectorReplayBuffer contains n HERReplayBuffer with same size.</p>
<p>It is used for storing transition from different environments yet keeping the order
of time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>total_size</strong> (<em>int</em>) – the total size of HERVectorReplayBuffer.</p></li>
<li><p><strong>buffer_num</strong> (<em>int</em>) – the number of HERReplayBuffer it uses, which are
under the same configuration.</p></li>
</ul>
</dd>
</dl>
<p>Other input arguments are the same as <a class="reference internal" href="#tianshou.data.HERReplayBuffer" title="tianshou.data.HERReplayBuffer"><code class="xref py py-class docutils literal notranslate"><span class="pre">HERReplayBuffer</span></code></a>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Please refer to <a class="reference internal" href="#tianshou.data.ReplayBuffer" title="tianshou.data.ReplayBuffer"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReplayBuffer</span></code></a> for other APIs’ usage.</p>
</div>
</dd></dl>

</section>
<section id="cachedreplaybuffer">
<h3>CachedReplayBuffer<a class="headerlink" href="#cachedreplaybuffer" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tianshou.data.CachedReplayBuffer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.data.</span></span><span class="sig-name descname"><span class="pre">CachedReplayBuffer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">main_buffer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#tianshou.data.ReplayBuffer" title="tianshou.data.buffer.base.ReplayBuffer"><span class="pre">ReplayBuffer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cached_buffer_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_episode_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/data/buffer/cached.html#CachedReplayBuffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.CachedReplayBuffer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tianshou.data.ReplayBufferManager" title="tianshou.data.buffer.manager.ReplayBufferManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReplayBufferManager</span></code></a></p>
<p>CachedReplayBuffer contains a given main buffer and n cached buffers,     <code class="docutils literal notranslate"><span class="pre">cached_buffer_num</span> <span class="pre">*</span> <span class="pre">ReplayBuffer(size=max_episode_length)</span></code>.</p>
<p>The memory layout is: <code class="docutils literal notranslate"><span class="pre">|</span> <span class="pre">main_buffer</span> <span class="pre">|</span> <span class="pre">cached_buffers[0]</span> <span class="pre">|</span> <span class="pre">cached_buffers[1]</span> <span class="pre">|</span> <span class="pre">...</span>
<span class="pre">|</span> <span class="pre">cached_buffers[cached_buffer_num</span> <span class="pre">-</span> <span class="pre">1]</span> <span class="pre">|</span></code>.</p>
<p>The data is first stored in cached buffers. When an episode is terminated, the data
will move to the main buffer and the corresponding cached buffer will be reset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>main_buffer</strong> (<a class="reference internal" href="#tianshou.data.ReplayBuffer" title="tianshou.data.ReplayBuffer"><em>ReplayBuffer</em></a>) – the main buffer whose <code class="docutils literal notranslate"><span class="pre">.update()</span></code> function
behaves normally.</p></li>
<li><p><strong>cached_buffer_num</strong> (<em>int</em>) – number of ReplayBuffer needs to be created for cached
buffer.</p></li>
<li><p><strong>max_episode_length</strong> (<em>int</em>) – the maximum length of one episode, used in each
cached buffer’s maxsize.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Please refer to <a class="reference internal" href="#tianshou.data.ReplayBuffer" title="tianshou.data.ReplayBuffer"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReplayBuffer</span></code></a> for other APIs’ usage.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.CachedReplayBuffer.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">RolloutBatchProtocol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/data/buffer/cached.html#CachedReplayBuffer.add"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.CachedReplayBuffer.add" title="Link to this definition">¶</a></dt>
<dd><p>Add a batch of data into CachedReplayBuffer.</p>
<p>Each of the data’s length (first dimension) must equal to the length of
buffer_ids. By default the buffer_ids is [0, 1, …, cached_buffer_num - 1].</p>
<p>Return (current_index, episode_reward, episode_length, episode_start_index)
with each of the shape (len(buffer_ids), …), where (current_index[i],
episode_reward[i], episode_length[i], episode_start_index[i]) refers to the
cached_buffer_ids[i]th cached buffer’s corresponding episode result.</p>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="collector">
<h2>Collector<a class="headerlink" href="#collector" title="Link to this heading">¶</a></h2>
<section id="id1">
<h3>Collector<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tianshou.data.Collector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.data.</span></span><span class="sig-name descname"><span class="pre">Collector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="tianshou.policy.html#tianshou.policy.BasePolicy" title="tianshou.policy.base.BasePolicy"><span class="pre">BasePolicy</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Env</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="tianshou.env.html#tianshou.env.BaseVectorEnv" title="tianshou.env.venvs.BaseVectorEnv"><span class="pre">BaseVectorEnv</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#tianshou.data.ReplayBuffer" title="tianshou.data.buffer.base.ReplayBuffer"><span class="pre">ReplayBuffer</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocess_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#tianshou.data.Batch" title="tianshou.data.batch.Batch"><span class="pre">Batch</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exploration_noise</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/data/collector.html#Collector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.Collector" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Collector enables the policy to interact with different types of envs with     exact number of steps or episodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>policy</strong> – an instance of the <a class="reference internal" href="tianshou.policy.html#tianshou.policy.BasePolicy" title="tianshou.policy.BasePolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePolicy</span></code></a> class.</p></li>
<li><p><strong>env</strong> – a <code class="docutils literal notranslate"><span class="pre">gym.Env</span></code> environment or an instance of the
<a class="reference internal" href="tianshou.env.html#tianshou.env.BaseVectorEnv" title="tianshou.env.BaseVectorEnv"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseVectorEnv</span></code></a> class.</p></li>
<li><p><strong>buffer</strong> – an instance of the <a class="reference internal" href="#tianshou.data.ReplayBuffer" title="tianshou.data.ReplayBuffer"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReplayBuffer</span></code></a> class.
If set to None, it will not store the data. Default to None.</p></li>
<li><p><strong>preprocess_fn</strong> (<em>function</em>) – a function called before the data has been added to
the buffer, see issue #42 and <a class="reference internal" href="../tutorials/cheatsheet.html#preprocess-fn"><span class="std std-ref">Handle Batched Data Stream in Collector</span></a>. Default to None.</p></li>
<li><p><strong>exploration_noise</strong> (<em>bool</em>) – determine whether the action needs to be modified
with corresponding policy’s exploration noise. If so, “policy.
exploration_noise(act, batch)” will be called automatically to add the
exploration noise into action. Default to False.</p></li>
</ul>
</dd>
</dl>
<p>The “preprocess_fn” is a function called before the data has been added to the
buffer with batch format. It will receive only “obs” and “env_id” when the
collector resets the environment, and will receive the keys “obs_next”, “rew”,
“terminated”, “truncated, “info”, “policy” and “env_id” in a normal env step.
Alternatively, it may also accept the keys “obs_next”, “rew”, “done”, “info”,
“policy” and “env_id”.
It returns either a dict or a <a class="reference internal" href="#tianshou.data.Batch" title="tianshou.data.Batch"><code class="xref py py-class docutils literal notranslate"><span class="pre">Batch</span></code></a> with the modified
keys and values. Examples are in “test/base/test_collector.py”.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please make sure the given environment has a time limitation if using n_episode
collect option.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In past versions of Tianshou, the replay buffer that was passed to <cite>__init__</cite>
was automatically reset. This is not done in the current implementation.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.Collector.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reset_buffer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gym_reset_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/data/collector.html#Collector.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.Collector.reset" title="Link to this definition">¶</a></dt>
<dd><p>Reset the environment, statistics, current data and possibly replay memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reset_buffer</strong> (<em>bool</em>) – if true, reset the replay buffer that is attached
to the collector.</p></li>
<li><p><strong>gym_reset_kwargs</strong> – extra keyword arguments to pass into the environment’s
reset function. Defaults to None (extra keyword arguments)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.Collector.reset_stat">
<span class="sig-name descname"><span class="pre">reset_stat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/data/collector.html#Collector.reset_stat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.Collector.reset_stat" title="Link to this definition">¶</a></dt>
<dd><p>Reset the statistic variables.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.Collector.reset_buffer">
<span class="sig-name descname"><span class="pre">reset_buffer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keep_statistics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/data/collector.html#Collector.reset_buffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.Collector.reset_buffer" title="Link to this definition">¶</a></dt>
<dd><p>Reset the data buffer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.Collector.reset_env">
<span class="sig-name descname"><span class="pre">reset_env</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gym_reset_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/data/collector.html#Collector.reset_env"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.Collector.reset_env" title="Link to this definition">¶</a></dt>
<dd><p>Reset all of the environments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.Collector.collect">
<span class="sig-name descname"><span class="pre">collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_episode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">render</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_grad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gym_reset_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/data/collector.html#Collector.collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.Collector.collect" title="Link to this definition">¶</a></dt>
<dd><p>Collect a specified number of step or episode.</p>
<p>To ensure unbiased sampling result with n_episode option, this function will
first collect <code class="docutils literal notranslate"><span class="pre">n_episode</span> <span class="pre">-</span> <span class="pre">env_num</span></code> episodes, then for the last <code class="docutils literal notranslate"><span class="pre">env_num</span></code>
episodes, they will be collected evenly from each env.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_step</strong> (<em>int</em>) – how many steps you want to collect.</p></li>
<li><p><strong>n_episode</strong> (<em>int</em>) – how many episodes you want to collect.</p></li>
<li><p><strong>random</strong> (<em>bool</em>) – whether to use random policy for collecting data. Default
to False.</p></li>
<li><p><strong>render</strong> (<em>float</em>) – the sleep time between rendering consecutive frames.
Default to None (no rendering).</p></li>
<li><p><strong>no_grad</strong> (<em>bool</em>) – whether to retain gradient in policy.forward(). Default to
True (no gradient retaining).</p></li>
<li><p><strong>gym_reset_kwargs</strong> – extra keyword arguments to pass into the environment’s
reset function. Defaults to None (extra keyword arguments)</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>One and only one collection number specification is permitted, either
<code class="docutils literal notranslate"><span class="pre">n_step</span></code> or <code class="docutils literal notranslate"><span class="pre">n_episode</span></code>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>A dict including the following keys</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n/ep</span></code> collected number of episodes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n/st</span></code> collected number of steps.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rews</span></code> array of episode reward over collected episodes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lens</span></code> array of episode length over collected episodes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">idxs</span></code> array of episode start index in buffer over collected episodes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rew</span></code> mean of episodic rewards.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">len</span></code> mean of episodic lengths.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rew_std</span></code> standard error of episodic rewards.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">len_std</span></code> standard error of episodic lengths.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="asynccollector">
<h3>AsyncCollector<a class="headerlink" href="#asynccollector" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tianshou.data.AsyncCollector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.data.</span></span><span class="sig-name descname"><span class="pre">AsyncCollector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="tianshou.policy.html#tianshou.policy.BasePolicy" title="tianshou.policy.base.BasePolicy"><span class="pre">BasePolicy</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="tianshou.env.html#tianshou.env.BaseVectorEnv" title="tianshou.env.venvs.BaseVectorEnv"><span class="pre">BaseVectorEnv</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#tianshou.data.ReplayBuffer" title="tianshou.data.buffer.base.ReplayBuffer"><span class="pre">ReplayBuffer</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocess_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#tianshou.data.Batch" title="tianshou.data.batch.Batch"><span class="pre">Batch</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exploration_noise</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/data/collector.html#AsyncCollector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.AsyncCollector" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tianshou.data.Collector" title="tianshou.data.collector.Collector"><code class="xref py py-class docutils literal notranslate"><span class="pre">Collector</span></code></a></p>
<p>Async Collector handles async vector environment.</p>
<p>The arguments are exactly the same as <a class="reference internal" href="#tianshou.data.Collector" title="tianshou.data.Collector"><code class="xref py py-class docutils literal notranslate"><span class="pre">Collector</span></code></a>, please
refer to <a class="reference internal" href="#tianshou.data.Collector" title="tianshou.data.Collector"><code class="xref py py-class docutils literal notranslate"><span class="pre">Collector</span></code></a> for more detailed explanation.</p>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.AsyncCollector.reset_env">
<span class="sig-name descname"><span class="pre">reset_env</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gym_reset_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/data/collector.html#AsyncCollector.reset_env"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.AsyncCollector.reset_env" title="Link to this definition">¶</a></dt>
<dd><p>Reset all of the environments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.AsyncCollector.collect">
<span class="sig-name descname"><span class="pre">collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_episode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">render</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_grad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gym_reset_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tianshou/data/collector.html#AsyncCollector.collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.AsyncCollector.collect" title="Link to this definition">¶</a></dt>
<dd><p>Collect a specified number of step or episode with async env setting.</p>
<p>This function doesn’t collect exactly n_step or n_episode number of
transitions. Instead, in order to support async setting, it may collect more
than given n_step or n_episode transitions and save into buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_step</strong> (<em>int</em>) – how many steps you want to collect.</p></li>
<li><p><strong>n_episode</strong> (<em>int</em>) – how many episodes you want to collect.</p></li>
<li><p><strong>random</strong> (<em>bool</em>) – whether to use random policy for collecting data. Default
to False.</p></li>
<li><p><strong>render</strong> (<em>float</em>) – the sleep time between rendering consecutive frames.
Default to None (no rendering).</p></li>
<li><p><strong>no_grad</strong> (<em>bool</em>) – whether to retain gradient in policy.forward(). Default to
True (no gradient retaining).</p></li>
<li><p><strong>gym_reset_kwargs</strong> – extra keyword arguments to pass into the environment’s
reset function. Defaults to None (extra keyword arguments)</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>One and only one collection number specification is permitted, either
<code class="docutils literal notranslate"><span class="pre">n_step</span></code> or <code class="docutils literal notranslate"><span class="pre">n_episode</span></code>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>A dict including the following keys</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n/ep</span></code> collected number of episodes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n/st</span></code> collected number of steps.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rews</span></code> array of episode reward over collected episodes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lens</span></code> array of episode length over collected episodes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">idxs</span></code> array of episode start index in buffer over collected episodes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rew</span></code> mean of episodic rewards.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">len</span></code> mean of episodic lengths.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rew_std</span></code> standard error of episodic rewards.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">len_std</span></code> standard error of episodic lengths.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="utils">
<h2>Utils<a class="headerlink" href="#utils" title="Link to this heading">¶</a></h2>
<section id="to-numpy">
<h3>to_numpy<a class="headerlink" href="#to-numpy" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="tianshou.data.to_numpy">
<span class="sig-prename descclassname"><span class="pre">tianshou.data.</span></span><span class="sig-name descname"><span class="pre">to_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tianshou.data.Batch" title="tianshou.data.batch.Batch"><span class="pre">Batch</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/tianshou/data/utils/converter.html#to_numpy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.to_numpy" title="Link to this definition">¶</a></dt>
<dd><p>Return an object without torch.Tensor.</p>
</dd></dl>

</section>
<section id="to-torch">
<h3>to_torch<a class="headerlink" href="#to-torch" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="tianshou.data.to_torch">
<span class="sig-prename descclassname"><span class="pre">tianshou.data.</span></span><span class="sig-name descname"><span class="pre">to_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tianshou.data.Batch" title="tianshou.data.batch.Batch"><span class="pre">Batch</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tianshou/data/utils/converter.html#to_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.to_torch" title="Link to this definition">¶</a></dt>
<dd><p>Return an object without np.ndarray.</p>
</dd></dl>

</section>
<section id="to-torch-as">
<h3>to_torch_as<a class="headerlink" href="#to-torch-as" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="tianshou.data.to_torch_as">
<span class="sig-prename descclassname"><span class="pre">tianshou.data.</span></span><span class="sig-name descname"><span class="pre">to_torch_as</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tianshou.data.Batch" title="tianshou.data.batch.Batch"><span class="pre">Batch</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tianshou/data/utils/converter.html#to_torch_as"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.to_torch_as" title="Link to this definition">¶</a></dt>
<dd><p>Return an object without np.ndarray.</p>
<p>Same as <code class="docutils literal notranslate"><span class="pre">to_torch(x,</span> <span class="pre">dtype=y.dtype,</span> <span class="pre">device=y.device)</span></code>.</p>
</dd></dl>

</section>
<section id="segmenttree">
<h3>SegmentTree<a class="headerlink" href="#segmenttree" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="tianshou.data.SegmentTree">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianshou.data.</span></span><span class="sig-name descname"><span class="pre">SegmentTree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianshou/data/utils/segtree.html#SegmentTree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.SegmentTree" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Implementation of Segment Tree.</p>
<p>The segment tree stores an array <code class="docutils literal notranslate"><span class="pre">arr</span></code> with size <code class="docutils literal notranslate"><span class="pre">n</span></code>. It supports value
update and fast query of the sum for the interval <code class="docutils literal notranslate"><span class="pre">[left,</span> <span class="pre">right)</span></code> in
O(log n) time. The detailed procedure is as follows:</p>
<ol class="arabic simple">
<li><p>Pad the array to have length of power of 2, so that leaf nodes in the     segment tree have the same depth.</p></li>
<li><p>Store the segment tree in a binary heap.</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>size</strong> (<em>int</em>) – the size of segment tree.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.SegmentTree.__len__">
<span class="sig-name descname"><span class="pre">__len__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="../_modules/tianshou/data/utils/segtree.html#SegmentTree.__len__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.SegmentTree.__len__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.SegmentTree.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/tianshou/data/utils/segtree.html#SegmentTree.__getitem__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.SegmentTree.__getitem__" title="Link to this definition">¶</a></dt>
<dd><p>Return self[index].</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.SegmentTree.__setitem__">
<span class="sig-name descname"><span class="pre">__setitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tianshou/data/utils/segtree.html#SegmentTree.__setitem__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.SegmentTree.__setitem__" title="Link to this definition">¶</a></dt>
<dd><p>Update values in segment tree.</p>
<p>Duplicate values in <code class="docutils literal notranslate"><span class="pre">index</span></code> are handled by numpy: later index
overwrites previous ones.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">[6 7 3 4]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.SegmentTree.reduce">
<span class="sig-name descname"><span class="pre">reduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/tianshou/data/utils/segtree.html#SegmentTree.reduce"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.SegmentTree.reduce" title="Link to this definition">¶</a></dt>
<dd><p>Return operation(value[start:end]).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tianshou.data.SegmentTree.get_prefix_sum_idx">
<span class="sig-name descname"><span class="pre">get_prefix_sum_idx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/tianshou/data/utils/segtree.html#SegmentTree.get_prefix_sum_idx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tianshou.data.SegmentTree.get_prefix_sum_idx" title="Link to this definition">¶</a></dt>
<dd><p>Find the index with given value.</p>
<p>Return the minimum index for each <code class="docutils literal notranslate"><span class="pre">v</span></code> in <code class="docutils literal notranslate"><span class="pre">value</span></code> so that
<span class="math notranslate nohighlight">\(v \le \mathrm{sums}_i\)</span>, where
<span class="math notranslate nohighlight">\(\mathrm{sums}_i = \sum_{j = 0}^{i} \mathrm{arr}_j\)</span>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Please make sure all of the values inside the segment tree are
non-negative when using this function.</p>
</div>
</dd></dl>

</dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../tutorials/cheatsheet.html" class="btn btn-neutral float-left" title="Cheat Sheet" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tianshou.env.html" class="btn btn-neutral float-right" title="tianshou.env" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Tianshou contributors..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>